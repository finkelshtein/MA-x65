<!DOCTYPE html>
<html xmlns="http://www.w3.org/1999/xhtml" lang="en" xml:lang="en"><head>

<meta charset="utf-8">
<meta name="generator" content="quarto-1.4.460">

<meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=yes">

<meta name="description" content="Lecture Notes for module MA-365/M65: Risk and Survival Models">

<title>MA-365/M65 Lecture Notes - 1&nbsp; Loss distributions</title>
<style>
code{white-space: pre-wrap;}
span.smallcaps{font-variant: small-caps;}
div.columns{display: flex; gap: min(4vw, 1.5em);}
div.column{flex: auto; overflow-x: auto;}
div.hanging-indent{margin-left: 1.5em; text-indent: -1.5em;}
ul.task-list{list-style: none;}
ul.task-list li input[type="checkbox"] {
  width: 0.8em;
  margin: 0 0.8em 0.2em -1em; /* quarto-specific, see https://github.com/quarto-dev/quarto-cli/issues/4556 */ 
  vertical-align: middle;
}
/* CSS for syntax highlighting */
pre > code.sourceCode { white-space: pre; position: relative; }
pre > code.sourceCode > span { line-height: 1.25; }
pre > code.sourceCode > span:empty { height: 1.2em; }
.sourceCode { overflow: visible; }
code.sourceCode > span { color: inherit; text-decoration: inherit; }
div.sourceCode { margin: 1em 0; }
pre.sourceCode { margin: 0; }
@media screen {
div.sourceCode { overflow: auto; }
}
@media print {
pre > code.sourceCode { white-space: pre-wrap; }
pre > code.sourceCode > span { text-indent: -5em; padding-left: 5em; }
}
pre.numberSource code
  { counter-reset: source-line 0; }
pre.numberSource code > span
  { position: relative; left: -4em; counter-increment: source-line; }
pre.numberSource code > span > a:first-child::before
  { content: counter(source-line);
    position: relative; left: -1em; text-align: right; vertical-align: baseline;
    border: none; display: inline-block;
    -webkit-touch-callout: none; -webkit-user-select: none;
    -khtml-user-select: none; -moz-user-select: none;
    -ms-user-select: none; user-select: none;
    padding: 0 4px; width: 4em;
  }
pre.numberSource { margin-left: 3em;  padding-left: 4px; }
div.sourceCode
  {   }
@media screen {
pre > code.sourceCode > span > a:first-child::before { text-decoration: underline; }
}
</style>


<script src="site_libs/quarto-nav/quarto-nav.js"></script>
<script src="site_libs/quarto-nav/headroom.min.js"></script>
<script src="site_libs/clipboard/clipboard.min.js"></script>
<script src="site_libs/quarto-search/autocomplete.umd.js"></script>
<script src="site_libs/quarto-search/fuse.min.js"></script>
<script src="site_libs/quarto-search/quarto-search.js"></script>
<meta name="quarto:offset" content="./">
<script src="site_libs/quarto-html/quarto.js"></script>
<script src="site_libs/quarto-html/popper.min.js"></script>
<script src="site_libs/quarto-html/tippy.umd.min.js"></script>
<script src="site_libs/quarto-html/anchor.min.js"></script>
<link href="site_libs/quarto-html/tippy.css" rel="stylesheet">
<link href="site_libs/quarto-html/quarto-syntax-highlighting.css" rel="stylesheet" id="quarto-text-highlighting-styles">
<script src="site_libs/bootstrap/bootstrap.min.js"></script>
<link href="site_libs/bootstrap/bootstrap-icons.css" rel="stylesheet">
<link href="site_libs/bootstrap/bootstrap.min.css" rel="stylesheet" id="quarto-bootstrap" data-mode="light">
<script id="quarto-search-options" type="application/json">{
  "location": "sidebar",
  "copy-button": false,
  "collapse-after": 3,
  "panel-placement": "start",
  "type": "textbox",
  "limit": 50,
  "keyboard-shortcut": [
    "f",
    "/",
    "s"
  ],
  "show-item-context": false,
  "language": {
    "search-no-results-text": "No results",
    "search-matching-documents-text": "matching documents",
    "search-copy-link-title": "Copy link to search",
    "search-hide-matches-text": "Hide additional matches",
    "search-more-match-text": "more match in this document",
    "search-more-matches-text": "more matches in this document",
    "search-clear-button-title": "Clear",
    "search-detached-cancel-button-title": "Cancel",
    "search-submit-button-title": "Submit",
    "search-label": "Search"
  }
}</script>
<script type="module" src="site_libs/quarto-ojs/quarto-ojs-runtime.js"></script>
<link href="site_libs/quarto-ojs/quarto-ojs.css" rel="stylesheet">

  <script src="https://polyfill.io/v3/polyfill.min.js?features=es6"></script>
  <script src="https://cdn.jsdelivr.net/npm/mathjax@3/es5/tex-chtml-full.js" type="text/javascript"></script>

<link rel="stylesheet" href="styles.css">
<meta property="og:title" content="MA-365/M65 Lecture Notes - 1&nbsp; Loss distributions">
<meta property="og:description" content="Lecture Notes for module MA-365/M65: Risk and Survival Models">
<meta property="og:site_name" content="MA-365/M65 Lecture Notes">
</head>

<body class="nav-sidebar floating fullcontent">

<div id="quarto-search-results"></div>
  <header id="quarto-header" class="headroom fixed-top">
  <nav class="quarto-secondary-nav">
    <div class="container-fluid d-flex">
      <button type="button" class="quarto-btn-toggle btn" data-bs-toggle="collapse" data-bs-target=".quarto-sidebar-collapse-item" aria-controls="quarto-sidebar" aria-expanded="false" aria-label="Toggle sidebar navigation" onclick="if (window.quartoToggleHeadroom) { window.quartoToggleHeadroom(); }">
        <i class="bi bi-layout-text-sidebar-reverse"></i>
      </button>
        <nav class="quarto-page-breadcrumbs" aria-label="breadcrumb"><ol class="breadcrumb"><li class="breadcrumb-item"><a href="./Ch-01.html"><span class="chapter-number">1</span>&nbsp; <span class="chapter-title">format: html</span></a></li></ol></nav>
        <a class="flex-grow-1" role="button" data-bs-toggle="collapse" data-bs-target=".quarto-sidebar-collapse-item" aria-controls="quarto-sidebar" aria-expanded="false" aria-label="Toggle sidebar navigation" onclick="if (window.quartoToggleHeadroom) { window.quartoToggleHeadroom(); }">      
        </a>
      <button type="button" class="btn quarto-search-button" aria-label="" onclick="window.quartoOpenSearch();">
        <i class="bi bi-search"></i>
      </button>
    </div>
  </nav>
</header>
<!-- content -->
<div id="quarto-content" class="quarto-container page-columns page-rows-contents page-layout-article">
<!-- sidebar -->
  <nav id="quarto-sidebar" class="sidebar collapse collapse-horizontal quarto-sidebar-collapse-item sidebar-navigation floating overflow-auto">
    <div class="pt-lg-2 mt-2 text-left sidebar-header">
    <div class="sidebar-title mb-0 py-0">
      <a href="./">MA-365/M65 Lecture Notes</a> 
    </div>
      </div>
        <div class="mt-2 flex-shrink-0 align-items-center">
        <div class="sidebar-search">
        <div id="quarto-search" class="" title="Search"></div>
        </div>
        </div>
    <div class="sidebar-menu-container"> 
    <ul class="list-unstyled mt-1">
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./index.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Overview</span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./Ch-01.html" class="sidebar-item-text sidebar-link active">
 <span class="menu-text"><span class="chapter-number">1</span>&nbsp; <span class="chapter-title">format: html</span></span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./Ch-02.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">2</span>&nbsp; <span class="chapter-title">Extreme value theory</span></span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./Ch-03.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">3</span>&nbsp; <span class="chapter-title">Copulas</span></span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./Ch-04.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">4</span>&nbsp; <span class="chapter-title">Reinsurance</span></span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./Ch-05.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">5</span>&nbsp; <span class="chapter-title">Compound distributions</span></span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./Ch-06.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">6</span>&nbsp; <span class="chapter-title">Survival models</span></span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./Ch-07.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">7</span>&nbsp; <span class="chapter-title">Estimations of lifetime distributions</span></span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./Ch-08.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">8</span>&nbsp; <span class="chapter-title">Proportional hazards models</span></span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./Ch-09.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">9</span>&nbsp; <span class="chapter-title">Exposed to risk</span></span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./Ch-10.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">10</span>&nbsp; <span class="chapter-title">Time series</span></span></a>
  </div>
</li>
    </ul>
    </div>
</nav>
<div id="quarto-sidebar-glass" class="quarto-sidebar-collapse-item" data-bs-toggle="collapse" data-bs-target=".quarto-sidebar-collapse-item"></div>
<!-- margin-sidebar -->
    
<!-- main -->
<main class="content" id="quarto-document-content">

<header id="title-block-header" class="quarto-title-block default">
<div class="quarto-title">
<h1 class="title"><span class="chapter-number">1</span>&nbsp; <span class="chapter-title">Loss distributions</span></h1>
</div>



<div class="quarto-title-meta">

    
  
    
  </div>
  


</header>


<p>ymaxexp— format: html</p>
<hr>
<div class="cell hidden">
<div class="sourceCode cell-code hidden" id="cb1" data-startfrom="6" data-source-offset="0"><pre class="sourceCode js code-with-copy"><code class="sourceCode javascript" style="counter-reset: source-line 5;"><span id="cb1-6"><a href="#cb1-6" aria-hidden="true" tabindex="-1"></a>mathfn <span class="op">=</span> <span class="pp">require</span>(<span class="st">'https://bundle.run/mathfn@1.1.0'</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display hidden">
<div id="ojs-cell-1" data-nodetype="declaration">

</div>
</div>
</div>
<div class="callout callout-style-default callout-note no-icon callout-titled">
<div class="callout-header d-flex align-content-center">
<div class="callout-icon-container">
<i class="callout-icon no-icon"></i>
</div>
<div class="callout-title-container flex-fill">
1.1 Probability distribution
</div>
</div>
<div class="callout-body-container callout-body">
<ul>
<li><p>Let <span class="math inline">\(X:\Omega\to\mathbb{R}\)</span> be a continuous random variable.</p></li>
<li><p>The <strong>cummulative distribution function (CDF)</strong> of <span class="math inline">\(X\)</span> is a <strong>non-decreasing</strong> function <span id="eq-1.1"><span class="math display">\[
F_X(x)=\mathbb{P}(X\leq x)\in[0,1].
\tag{1.1}\]</span></span></p></li>
<li><p>The <strong>probability density function (PDF)</strong> (a.k.a. <strong>probability density</strong>) of <span class="math inline">\(X\)</span> is <span id="eq-1.2"><span class="math display">\[
f_X(x)=F'_X(x)\geq0.
\tag{1.2}\]</span></span></p></li>
<li><p>Relation: <span id="eq-1.31212"><span class="math display">\[
\mathbb{P}(a\leq X \leq b) = \int_a^b f_X(x)\,dx=F_X(b)-F_X(a).
\tag{1.3}\]</span></span></p></li>
<li><p>For a <span class="math inline">\(k\in\mathbb{N}\)</span>, the <strong>moment of order <span class="math inline">\(k\)</span></strong> of <span class="math inline">\(X\)</span> is <span id="eq-kthmoment"><span class="math display">\[
m_k=m_{k,X}=\mathbb{E}(X^k)=\int_\mathbb{R} x^k \, f_X(x)\,dx.
\tag{1.4}\]</span></span></p></li>
<li><p>The <strong>moment generator function (MGM)</strong> is <span id="eq-1.5"><span class="math display">\[
M_X(t)=\mathbb{E}(e^{tX})=\int_\mathbb{R} e^{tx} \, f_X(x)\,dx\geq0.
\tag{1.5}\]</span></span></p></li>
<li><p>Relation: <span id="eq-1.6"><span class="math display">\[
M_X(t)=1+\sum_{k=1}^\infty\frac{m_k}{k!}t^k.
\tag{1.6}\]</span></span></p></li>
</ul>
</div>
</div>
<div class="callout callout-style-default callout-tip no-icon callout-titled">
<div class="callout-header d-flex align-content-center">
<div class="callout-icon-container">
<i class="callout-icon no-icon"></i>
</div>
<div class="callout-title-container flex-fill">
1.3 Remark
</div>
</div>
<div class="callout-body-container callout-body">
<ul>
<li><p>Recall that functions <span class="math inline">\(\dfrac{1}{1+|x|^\beta}\)</span> and <span class="math inline">\(\dfrac{1}{(1+|x|)^\beta}\)</span> are integrable on <span class="math inline">\(\mathbb{R}\)</span> iff <span class="math inline">\(\beta&gt;1\)</span>.</p></li>
<li><p>Note that if <span class="math inline">\(f_X(x)\)</span> is continuous on <span class="math inline">\(\mathbb{R}\)</span>, it’s integrable on arbitrary large interval <span class="math inline">\([-r,r]\)</span>, <span class="math inline">\(r&gt;0\)</span>. Therefore, if there exists <span class="math inline">\(A&gt;\)</span> and <span class="math inline">\(r&gt;0\)</span> such that <span id="eq-sufcondint"><span class="math display">\[
|f_X(x)|\leq \frac{A}{1+|x|^\beta}, \qquad |x|&gt;r,
\tag{1.7}\]</span></span> and <span class="math inline">\(\beta&gt;1\)</span>, then indeed, <span class="math inline">\(\int\limits_{\mathbb{R}}|f_X(x)|\,dx&lt;\infty\)</span>.</p></li>
<li><p>As a result, if <span class="math inline">\(\beta&gt;k+1\)</span> in (<a href="#eq-sufcondint" class="quarto-xref"><span>1.7</span></a>), then the <span class="math inline">\(k\)</span>-th moment <span class="math inline">\(m_k\)</span> in (<a href="#eq-kthmoment" class="quarto-xref"><span>1.4</span></a>) is well defined and finite.</p></li>
<li><p>Examples of such probability densities <span class="math inline">\(f_X(x)\)</span> may be, apart from the obvious <span class="math inline">\(\dfrac{1}{1+|x|^\beta}\)</span> and <span class="math inline">\(\dfrac{1}{(1+|x|)^\beta}\)</span> with <span class="math inline">\(\beta&gt;k+1\)</span>, also the considered below Weibull function <span id="eq-Weibull"><span class="math display">\[
f_X(x)=e^{-a |x|^b}
\tag{1.8}\]</span></span> with <strong>any</strong> positive <span class="math inline">\(a,b&gt;0\)</span>.</p></li>
<li><p>Moreover, if in (<a href="#eq-Weibull" class="quarto-xref"><span>1.8</span></a>) <span class="math inline">\(b&gt;1\)</span>, then <span class="math inline">\(0&lt; M_X(t)&lt;\infty\)</span>.</p></li>
</ul>
</div>
</div>
<div class="callout callout-style-default callout-note no-icon callout-titled">
<div class="callout-header d-flex align-content-center">
<div class="callout-icon-container">
<i class="callout-icon no-icon"></i>
</div>
<div class="callout-title-container flex-fill">
1.4 The exponential distribution
</div>
</div>
<div class="callout-body-container callout-body">
<p>A random variable <span class="math inline">\(X:\Omega\to\mathbb{R}\)</span> has the <strong>exponential distribution</strong> with parameter <span class="math inline">\(\lambda&gt;0\)</span> if its CDF is <span id="eq-1.9"><span class="math display">\[
F(x)=1-e^{-\lambda x}, \quad x\geq0.
\tag{1.9}\]</span></span></p>
<p>Here and below, when we write a restriction on <span class="math inline">\(x\)</span>, we mean that function is <span class="math inline">\(0\)</span> otherwise, i.e.&nbsp;here <span class="math inline">\(F(x)=0\)</span> for <span class="math inline">\(x&lt;0\)</span>.</p>
<p>Then the PDF is <span id="eq-1.10"><span class="math display">\[
f(x)=\lambda e^{-\lambda x}, \quad x\geq0.
\tag{1.10}\]</span></span></p>
<p>Next, <span id="eq-1.11"><span class="math display">\[
\mathbb{E}(X)=\frac1{\lambda},
\tag{1.11}\]</span></span> <span id="eq-1.12"><span class="math display">\[
\mathrm{Var}(X)=\frac1{\lambda^2}= \bigl( \mathbb{E}(X) \bigr)^2,
\tag{1.12}\]</span></span> <span id="eq-1.13"><span class="math display">\[
\mathbb{E}(X^2)=\frac2{\lambda^2}=2\bigl( \mathbb{E}(X) \bigr)^2.
\tag{1.13}\]</span></span> The MGM if defined for <span class="math inline">\(t&lt;\lambda\)</span> only: <span class="math display">\[
M(t)=\biggl(1-\frac{t}{\lambda}\biggr)^{-1}=\frac{\lambda}{\lambda-t}.
\]</span> The notation is <span id="eq-1.14"><span class="math display">\[
X\sim Exp(\lambda).
\tag{1.14}\]</span></span></p>
</div>
</div>
<div class="sourceCode cell-code hidden" id="cb2" data-startfrom="140" data-source-offset="-1"><pre class="sourceCode js code-with-copy"><code class="sourceCode javascript" style="counter-reset: source-line 139;"><span id="cb2-140"><a href="#cb2-140" aria-hidden="true" tabindex="-1"></a>viewof l <span class="op">=</span> Inputs<span class="op">.</span><span class="fu">range</span>([<span class="fl">0.1</span><span class="op">,</span> <span class="dv">10</span>]<span class="op">,</span> { <span class="dt">value</span><span class="op">:</span> <span class="dv">1</span><span class="op">,</span> <span class="dt">step</span><span class="op">:</span> <span class="fl">0.001</span><span class="op">,</span> <span class="dt">label</span><span class="op">:</span> <span class="fu">tex</span><span class="vs">`</span><span class="sc">\l</span><span class="vs">ambda:`</span> })</span>
<span id="cb2-141"><a href="#cb2-141" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb2-142"><a href="#cb2-142" aria-hidden="true" tabindex="-1"></a>viewof xmexp <span class="op">=</span> Inputs<span class="op">.</span><span class="fu">range</span>([<span class="dv">1</span><span class="op">,</span> <span class="dv">100</span>]<span class="op">,</span> { <span class="dt">value</span><span class="op">:</span> <span class="dv">10</span><span class="op">,</span> <span class="dt">step</span><span class="op">:</span> <span class="dv">1</span><span class="op">,</span> <span class="dt">label</span><span class="op">:</span> <span class="fu">tex</span><span class="vs">`x_</span><span class="sc">\m</span><span class="vs">athrm{max}`</span> })</span>
<span id="cb2-143"><a href="#cb2-143" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb2-144"><a href="#cb2-144" aria-hidden="true" tabindex="-1"></a>ymaxexp <span class="op">=</span> d3<span class="op">.</span><span class="fu">max</span>(d3<span class="op">.</span><span class="fu">range</span>(<span class="dv">0</span><span class="op">,</span> xmexp<span class="op">,</span> <span class="fl">0.01</span>)<span class="op">.</span><span class="fu">map</span>(t <span class="kw">=&gt;</span> l<span class="op">*</span><span class="bu">Math</span><span class="op">.</span><span class="fu">exp</span>(<span class="op">-</span>l <span class="op">*</span> t)))</span>
<span id="cb2-145"><a href="#cb2-145" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb2-146"><a href="#cb2-146" aria-hidden="true" tabindex="-1"></a>Plot<span class="op">.</span><span class="fu">plot</span>({</span>
<span id="cb2-147"><a href="#cb2-147" aria-hidden="true" tabindex="-1"></a>  <span class="dt">x</span><span class="op">:</span> { <span class="dt">domain</span><span class="op">:</span> [<span class="op">-</span><span class="fl">0.1</span><span class="op">,</span> xmexp] }<span class="op">,</span></span>
<span id="cb2-148"><a href="#cb2-148" aria-hidden="true" tabindex="-1"></a>  <span class="dt">y</span><span class="op">:</span> { <span class="dt">domain</span><span class="op">:</span> [<span class="op">-</span><span class="fl">0.1</span><span class="op">*</span>ymaxexp<span class="op">,</span> ymaxexp<span class="op">*</span><span class="fl">1.2</span>] }<span class="op">,</span></span>
<span id="cb2-149"><a href="#cb2-149" aria-hidden="true" tabindex="-1"></a>  <span class="dt">width</span><span class="op">:</span> <span class="dv">640</span><span class="op">,</span></span>
<span id="cb2-150"><a href="#cb2-150" aria-hidden="true" tabindex="-1"></a>  <span class="dt">height</span><span class="op">:</span> <span class="dv">240</span><span class="op">,</span></span>
<span id="cb2-151"><a href="#cb2-151" aria-hidden="true" tabindex="-1"></a>  <span class="dt">marks</span><span class="op">:</span> [</span>
<span id="cb2-152"><a href="#cb2-152" aria-hidden="true" tabindex="-1"></a>    Plot<span class="op">.</span><span class="fu">line</span>(</span>
<span id="cb2-153"><a href="#cb2-153" aria-hidden="true" tabindex="-1"></a>      d3</span>
<span id="cb2-154"><a href="#cb2-154" aria-hidden="true" tabindex="-1"></a>        <span class="op">.</span><span class="fu">range</span>(<span class="dv">0</span><span class="op">,</span> xmexp<span class="op">,</span> <span class="fl">0.1</span>)</span>
<span id="cb2-155"><a href="#cb2-155" aria-hidden="true" tabindex="-1"></a>        <span class="op">.</span><span class="fu">map</span>(t <span class="kw">=&gt;</span> [</span>
<span id="cb2-156"><a href="#cb2-156" aria-hidden="true" tabindex="-1"></a>          t<span class="op">,</span></span>
<span id="cb2-157"><a href="#cb2-157" aria-hidden="true" tabindex="-1"></a>          l<span class="op">*</span><span class="bu">Math</span><span class="op">.</span><span class="fu">exp</span>(<span class="op">-</span>l <span class="op">*</span> t)</span>
<span id="cb2-158"><a href="#cb2-158" aria-hidden="true" tabindex="-1"></a>        ])<span class="op">,</span>{</span>
<span id="cb2-159"><a href="#cb2-159" aria-hidden="true" tabindex="-1"></a>        <span class="dt">strokeWidth</span><span class="op">:</span> <span class="dv">3</span><span class="op">,</span></span>
<span id="cb2-160"><a href="#cb2-160" aria-hidden="true" tabindex="-1"></a>        <span class="dt">stroke</span><span class="op">:</span> <span class="st">"steelblue"</span></span>
<span id="cb2-161"><a href="#cb2-161" aria-hidden="true" tabindex="-1"></a>      }</span>
<span id="cb2-162"><a href="#cb2-162" aria-hidden="true" tabindex="-1"></a>    )<span class="op">,</span></span>
<span id="cb2-163"><a href="#cb2-163" aria-hidden="true" tabindex="-1"></a>      Plot<span class="op">.</span><span class="fu">ruleX</span>([<span class="dv">0</span>])<span class="op">,</span></span>
<span id="cb2-164"><a href="#cb2-164" aria-hidden="true" tabindex="-1"></a>      Plot<span class="op">.</span><span class="fu">ruleY</span>([<span class="dv">0</span>])<span class="op">,</span></span>
<span id="cb2-165"><a href="#cb2-165" aria-hidden="true" tabindex="-1"></a>      Plot<span class="op">.</span><span class="fu">axisX</span>({ <span class="dt">y</span><span class="op">:</span> <span class="dv">0</span> })<span class="op">,</span></span>
<span id="cb2-166"><a href="#cb2-166" aria-hidden="true" tabindex="-1"></a>      Plot<span class="op">.</span><span class="fu">axisY</span>({ <span class="dt">x</span><span class="op">:</span> <span class="dv">0</span> })</span>
<span id="cb2-167"><a href="#cb2-167" aria-hidden="true" tabindex="-1"></a>  ]</span>
<span id="cb2-168"><a href="#cb2-168" aria-hidden="true" tabindex="-1"></a>})</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div id="fig-Exp" class="quarto-figure quarto-figure-center anchored">
<figure class="quarto-float quarto-float-fig figure">
<div aria-describedby="fig-Exp-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
<div class="cell">
<div class="cell-output cell-output-display">
<div>
<div id="ojs-cell-2-1" data-nodetype="declaration">

</div>
</div>
</div>
<div class="cell-output cell-output-display">
<div>
<div id="ojs-cell-2-2" data-nodetype="declaration">

</div>
</div>
</div>
<div class="cell-output cell-output-display">
<div>
<div id="ojs-cell-2-3" data-nodetype="declaration">

</div>
</div>
</div>
<div class="cell-output cell-output-display">
<div>
<div id="ojs-cell-2-4" data-nodetype="expression">

</div>
</div>
</div>
</div>
</div>
<figcaption class="figure quarto-float-caption quarto-float-fig" id="fig-Exp-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
Figure&nbsp;1.1: Graph of <span class="math inline">\(f(x)=\lambda e^{-\lambda x}\)</span>
</figcaption>
</figure>
</div>
<div class="callout callout-style-default callout-note no-icon callout-titled">
<div class="callout-header d-flex align-content-center">
<div class="callout-icon-container">
<i class="callout-icon no-icon"></i>
</div>
<div class="callout-title-container flex-fill">
1.5 The gamma distribution
</div>
</div>
<div class="callout-body-container callout-body">
<p>A random variable <span class="math inline">\(X:\Omega\to\mathbb{R}\)</span> has the <strong>gamma distribution</strong> with parameters <span class="math inline">\(\alpha&gt;0\)</span> and <span class="math inline">\(\lambda&gt;0\)</span> if its PDF is <span id="eq-1.15"><span class="math display">\[
f(x)=\frac{\lambda^\alpha}{\Gamma(\alpha)}x^{\alpha-1} e^{-\lambda x}, \quad x\geq0.
\tag{1.15}\]</span></span> Here <span id="eq-1.16"><span class="math display">\[
\Gamma(\alpha):=\int_0^\infty t^{\alpha-1}e^{-t}\,dt, \quad \alpha&gt;0
\tag{1.16}\]</span></span> is the gamma function.</p>
<p>The following formulas hold: <span id="eq-1.17"><span class="math display">\[
\mathbb{E}(X)=\frac{\alpha}{\lambda},
\tag{1.17}\]</span></span> <span id="eq-1.18"><span class="math display">\[
\mathrm{Var}(X)=\frac{\alpha}{\lambda^2},
\tag{1.18}\]</span></span> <span id="eq-1.19"><span class="math display">\[
M_X(t)=\biggl(1-\frac{t}{\lambda}\biggr)^{-\alpha}=\frac{\lambda^\alpha}{(\lambda-t)^\alpha}, \quad t&lt;\lambda.
\tag{1.19}\]</span></span> The notation is <span class="math display">\[
X\sim \Gamma(\alpha,\lambda).
\]</span></p>
</div>
</div>
<div class="sourceCode cell-code hidden" id="cb3" data-startfrom="213" data-source-offset="-0"><pre class="sourceCode js code-with-copy"><code class="sourceCode javascript" style="counter-reset: source-line 212;"><span id="cb3-213"><a href="#cb3-213" aria-hidden="true" tabindex="-1"></a>viewof a <span class="op">=</span> Inputs<span class="op">.</span><span class="fu">range</span>([<span class="fl">0.1</span><span class="op">,</span> <span class="dv">10</span>]<span class="op">,</span> { <span class="dt">value</span><span class="op">:</span> <span class="dv">1</span><span class="op">,</span> <span class="dt">step</span><span class="op">:</span> <span class="fl">0.001</span><span class="op">,</span> <span class="dt">label</span><span class="op">:</span> <span class="fu">tex</span><span class="vs">`</span><span class="sc">\a</span><span class="vs">lpha:`</span> })</span>
<span id="cb3-214"><a href="#cb3-214" aria-hidden="true" tabindex="-1"></a>viewof l2 <span class="op">=</span> Inputs<span class="op">.</span><span class="fu">range</span>([<span class="fl">0.1</span><span class="op">,</span> <span class="dv">10</span>]<span class="op">,</span> { <span class="dt">value</span><span class="op">:</span> <span class="dv">1</span><span class="op">,</span> <span class="dt">step</span><span class="op">:</span> <span class="fl">0.001</span><span class="op">,</span> <span class="dt">label</span><span class="op">:</span> <span class="fu">tex</span><span class="vs">`</span><span class="sc">\l</span><span class="vs">ambda:`</span> })</span>
<span id="cb3-215"><a href="#cb3-215" aria-hidden="true" tabindex="-1"></a>viewof xmgamma <span class="op">=</span> Inputs<span class="op">.</span><span class="fu">range</span>([<span class="dv">1</span><span class="op">,</span> <span class="dv">100</span>]<span class="op">,</span> { <span class="dt">value</span><span class="op">:</span> <span class="dv">10</span><span class="op">,</span> <span class="dt">step</span><span class="op">:</span> <span class="dv">1</span><span class="op">,</span> <span class="dt">label</span><span class="op">:</span> <span class="fu">tex</span><span class="vs">`x_</span><span class="sc">\m</span><span class="vs">athrm{max}`</span> })</span>
<span id="cb3-216"><a href="#cb3-216" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb3-217"><a href="#cb3-217" aria-hidden="true" tabindex="-1"></a><span class="kw">function</span> <span class="fu">gamma</span>(t<span class="op">,</span>alpha<span class="op">,</span>lambda){</span>
<span id="cb3-218"><a href="#cb3-218" aria-hidden="true" tabindex="-1"></a>  <span class="cf">return</span> ((lambda<span class="op">**</span>alpha)<span class="op">/</span>mathfn<span class="op">.</span><span class="fu">gamma</span>(alpha))<span class="op">*</span>(t<span class="op">**</span>(alpha<span class="op">-</span><span class="dv">1</span>))<span class="op">*</span><span class="bu">Math</span><span class="op">.</span><span class="fu">exp</span>(<span class="op">-</span>lambda <span class="op">*</span> t)<span class="op">;</span></span>
<span id="cb3-219"><a href="#cb3-219" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb3-220"><a href="#cb3-220" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb3-221"><a href="#cb3-221" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb3-222"><a href="#cb3-222" aria-hidden="true" tabindex="-1"></a>ymaxgamma <span class="op">=</span> d3<span class="op">.</span><span class="fu">max</span>(d3<span class="op">.</span><span class="fu">range</span>(<span class="fl">0.1</span><span class="op">,</span> xmgamma<span class="op">,</span> <span class="fl">0.001</span>)<span class="op">.</span><span class="fu">map</span>(t <span class="kw">=&gt;</span> <span class="fu">gamma</span>(t<span class="op">,</span>a<span class="op">,</span>l2)))</span>
<span id="cb3-223"><a href="#cb3-223" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb3-224"><a href="#cb3-224" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb3-225"><a href="#cb3-225" aria-hidden="true" tabindex="-1"></a>Plot<span class="op">.</span><span class="fu">plot</span>({</span>
<span id="cb3-226"><a href="#cb3-226" aria-hidden="true" tabindex="-1"></a>  <span class="dt">x</span><span class="op">:</span> { <span class="dt">domain</span><span class="op">:</span> [<span class="fl">0.1</span><span class="op">,</span> xmgamma] }<span class="op">,</span></span>
<span id="cb3-227"><a href="#cb3-227" aria-hidden="true" tabindex="-1"></a>  <span class="dt">y</span><span class="op">:</span> { <span class="dt">domain</span><span class="op">:</span> [<span class="op">-</span><span class="fl">0.1</span><span class="op">*</span>ymaxgamma<span class="op">,</span> ymaxgamma<span class="op">*</span><span class="fl">1.2</span>] }<span class="op">,</span></span>
<span id="cb3-228"><a href="#cb3-228" aria-hidden="true" tabindex="-1"></a>  <span class="dt">width</span><span class="op">:</span> <span class="dv">640</span><span class="op">,</span></span>
<span id="cb3-229"><a href="#cb3-229" aria-hidden="true" tabindex="-1"></a>  <span class="dt">height</span><span class="op">:</span> <span class="dv">240</span><span class="op">,</span></span>
<span id="cb3-230"><a href="#cb3-230" aria-hidden="true" tabindex="-1"></a>  <span class="dt">marks</span><span class="op">:</span> [</span>
<span id="cb3-231"><a href="#cb3-231" aria-hidden="true" tabindex="-1"></a>    Plot<span class="op">.</span><span class="fu">line</span>(</span>
<span id="cb3-232"><a href="#cb3-232" aria-hidden="true" tabindex="-1"></a>      d3</span>
<span id="cb3-233"><a href="#cb3-233" aria-hidden="true" tabindex="-1"></a>        <span class="op">.</span><span class="fu">range</span>(<span class="dv">0</span><span class="op">,</span>xmgamma<span class="op">,</span> <span class="fl">0.01</span>)</span>
<span id="cb3-234"><a href="#cb3-234" aria-hidden="true" tabindex="-1"></a>        <span class="op">.</span><span class="fu">map</span>(t <span class="kw">=&gt;</span> [t<span class="op">,</span> <span class="fu">gamma</span>(t<span class="op">,</span>a<span class="op">,</span>l2)])<span class="op">,</span>{</span>
<span id="cb3-235"><a href="#cb3-235" aria-hidden="true" tabindex="-1"></a>        <span class="dt">strokeWidth</span><span class="op">:</span> <span class="dv">3</span><span class="op">,</span></span>
<span id="cb3-236"><a href="#cb3-236" aria-hidden="true" tabindex="-1"></a>        <span class="dt">stroke</span><span class="op">:</span> <span class="st">"steelblue"</span></span>
<span id="cb3-237"><a href="#cb3-237" aria-hidden="true" tabindex="-1"></a>      }</span>
<span id="cb3-238"><a href="#cb3-238" aria-hidden="true" tabindex="-1"></a>    )<span class="op">,</span></span>
<span id="cb3-239"><a href="#cb3-239" aria-hidden="true" tabindex="-1"></a>      Plot<span class="op">.</span><span class="fu">ruleX</span>([<span class="dv">0</span>])<span class="op">,</span></span>
<span id="cb3-240"><a href="#cb3-240" aria-hidden="true" tabindex="-1"></a>      Plot<span class="op">.</span><span class="fu">ruleY</span>([<span class="dv">0</span>])<span class="op">,</span></span>
<span id="cb3-241"><a href="#cb3-241" aria-hidden="true" tabindex="-1"></a>      Plot<span class="op">.</span><span class="fu">axisX</span>({ <span class="dt">y</span><span class="op">:</span> <span class="dv">0</span> })<span class="op">,</span></span>
<span id="cb3-242"><a href="#cb3-242" aria-hidden="true" tabindex="-1"></a>      Plot<span class="op">.</span><span class="fu">axisY</span>({ <span class="dt">x</span><span class="op">:</span> <span class="dv">0</span> })</span>
<span id="cb3-243"><a href="#cb3-243" aria-hidden="true" tabindex="-1"></a>  ]</span>
<span id="cb3-244"><a href="#cb3-244" aria-hidden="true" tabindex="-1"></a>})</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div id="fig-gamma" class="quarto-figure quarto-figure-center anchored">
<figure class="quarto-float quarto-float-fig figure">
<div aria-describedby="fig-gamma-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
<div class="cell">
<div class="cell-output cell-output-display">
<div>
<div id="ojs-cell-3-1" data-nodetype="declaration">

</div>
</div>
</div>
<div class="cell-output cell-output-display">
<div>
<div id="ojs-cell-3-2" data-nodetype="declaration">

</div>
</div>
</div>
<div class="cell-output cell-output-display">
<div>
<div id="ojs-cell-3-3" data-nodetype="declaration">

</div>
</div>
</div>
<div class="cell-output cell-output-display">
<div>
<div id="ojs-cell-3-4" data-nodetype="declaration">

</div>
</div>
</div>
<div class="cell-output cell-output-display">
<div>
<div id="ojs-cell-3-5" data-nodetype="declaration">

</div>
</div>
</div>
<div class="cell-output cell-output-display">
<div>
<div id="ojs-cell-3-6" data-nodetype="expression">

</div>
</div>
</div>
</div>
</div>
<figcaption class="figure quarto-float-caption quarto-float-fig" id="fig-gamma-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
Figure&nbsp;1.2: Graph of <span class="math inline">\(f(x)=\dfrac{\lambda^\alpha}{\Gamma(\alpha)}x^{\alpha-1} e^{-\lambda x}\)</span>
</figcaption>
</figure>
</div>
<div class="callout callout-style-default callout-note no-icon callout-titled">
<div class="callout-header d-flex align-content-center">
<div class="callout-icon-container">
<i class="callout-icon no-icon"></i>
</div>
<div class="callout-title-container flex-fill">
1.6 The normal distribution
</div>
</div>
<div class="callout-body-container callout-body">
<p>A random variable <span class="math inline">\(X:\Omega\to\mathbb{R}\)</span> has the <strong>normal distribution</strong> with the mean <span class="math inline">\(\mu\)</span> and the variance <span class="math inline">\(\sigma^2\)</span> if <span id="eq-1.20"><span class="math display">\[
f_X(x)=\frac1{\sigma\sqrt{2\pi}}e^{-\frac1{2\sigma^2}(x-\mu)^2}.
\tag{1.20}\]</span></span> Indeed, <span id="eq-1.21"><span class="math display">\[
\mathbb{E}(X)=\mu, \quad \mathrm{Var}(X)=\sigma^2.
\tag{1.21}\]</span></span> The MGF is defined now everywhere: <span id="eq-1.22"><span class="math display">\[
M_X(t)=e^{\mu t +\frac12 \sigma^2 t^2}, \quad t\in\mathbb{R}.
\tag{1.22}\]</span></span> Notation <span class="math display">\[
X\sim N(\mu,\sigma^2).
\]</span></p>
</div>
</div>
<div class="sourceCode cell-code hidden" id="cb4" data-startfrom="281" data-source-offset="-0"><pre class="sourceCode js code-with-copy"><code class="sourceCode javascript" style="counter-reset: source-line 280;"><span id="cb4-281"><a href="#cb4-281" aria-hidden="true" tabindex="-1"></a>viewof mu <span class="op">=</span> Inputs<span class="op">.</span><span class="fu">range</span>([<span class="op">-</span><span class="fl">0.7</span><span class="op">*</span>xmgauss<span class="op">,</span> <span class="fl">0.7</span><span class="op">*</span>xmgauss]<span class="op">,</span> { <span class="dt">value</span><span class="op">:</span> <span class="dv">0</span><span class="op">,</span> <span class="dt">step</span><span class="op">:</span> <span class="fl">0.001</span><span class="op">,</span> <span class="dt">label</span><span class="op">:</span> <span class="fu">tex</span><span class="vs">`</span><span class="sc">\m</span><span class="vs">u:`</span> })</span>
<span id="cb4-282"><a href="#cb4-282" aria-hidden="true" tabindex="-1"></a>viewof sigma <span class="op">=</span> Inputs<span class="op">.</span><span class="fu">range</span>([<span class="fl">0.1</span><span class="op">,</span> <span class="dv">10</span>]<span class="op">,</span> { <span class="dt">value</span><span class="op">:</span> <span class="dv">1</span><span class="op">,</span> <span class="dt">step</span><span class="op">:</span> <span class="fl">0.001</span><span class="op">,</span> <span class="dt">label</span><span class="op">:</span> <span class="fu">tex</span><span class="vs">`</span><span class="sc">\s</span><span class="vs">igma:`</span> })</span>
<span id="cb4-283"><a href="#cb4-283" aria-hidden="true" tabindex="-1"></a>viewof xmgauss <span class="op">=</span> Inputs<span class="op">.</span><span class="fu">range</span>([<span class="dv">1</span><span class="op">,</span> <span class="dv">100</span>]<span class="op">,</span> { <span class="dt">value</span><span class="op">:</span> <span class="dv">10</span><span class="op">,</span> <span class="dt">step</span><span class="op">:</span> <span class="dv">1</span><span class="op">,</span> <span class="dt">label</span><span class="op">:</span> <span class="fu">tex</span><span class="vs">`x_</span><span class="sc">\m</span><span class="vs">athrm{max}`</span> })</span>
<span id="cb4-284"><a href="#cb4-284" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb4-285"><a href="#cb4-285" aria-hidden="true" tabindex="-1"></a><span class="kw">function</span> <span class="fu">gauss</span>(t<span class="op">,</span>mu<span class="op">,</span>sigma){</span>
<span id="cb4-286"><a href="#cb4-286" aria-hidden="true" tabindex="-1"></a>  <span class="cf">return</span> <span class="bu">Math</span><span class="op">.</span><span class="fu">exp</span>(<span class="op">-</span>(<span class="dv">1</span><span class="op">/</span>(<span class="dv">2</span><span class="op">*</span>sigma<span class="op">**</span><span class="dv">2</span>))<span class="op">*</span>(t<span class="op">-</span>mu)<span class="op">**</span><span class="dv">2</span>)<span class="op">/</span>(sigma<span class="op">*</span><span class="bu">Math</span><span class="op">.</span><span class="fu">sqrt</span>(<span class="dv">2</span><span class="op">*</span><span class="bu">Math</span><span class="op">.</span><span class="cn">PI</span>))<span class="op">;</span></span>
<span id="cb4-287"><a href="#cb4-287" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb4-288"><a href="#cb4-288" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb4-289"><a href="#cb4-289" aria-hidden="true" tabindex="-1"></a>ymaxgauss <span class="op">=</span> d3<span class="op">.</span><span class="fu">max</span>(d3<span class="op">.</span><span class="fu">range</span>(<span class="op">-</span>xmgauss<span class="op">,</span> xmgauss<span class="op">,</span> <span class="fl">0.01</span>)<span class="op">.</span><span class="fu">map</span>(t <span class="kw">=&gt;</span> <span class="fu">gauss</span>(t<span class="op">,</span>mu<span class="op">,</span>sigma)))</span>
<span id="cb4-290"><a href="#cb4-290" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb4-291"><a href="#cb4-291" aria-hidden="true" tabindex="-1"></a>Plot<span class="op">.</span><span class="fu">plot</span>({</span>
<span id="cb4-292"><a href="#cb4-292" aria-hidden="true" tabindex="-1"></a>  <span class="dt">x</span><span class="op">:</span> { <span class="dt">domain</span><span class="op">:</span> [<span class="op">-</span>xmgauss<span class="op">,</span> xmgauss] }<span class="op">,</span></span>
<span id="cb4-293"><a href="#cb4-293" aria-hidden="true" tabindex="-1"></a>  <span class="dt">y</span><span class="op">:</span> { <span class="dt">domain</span><span class="op">:</span> [<span class="op">-</span>ymaxgauss<span class="op">*</span><span class="fl">0.1</span><span class="op">,</span> ymaxgauss<span class="op">*</span><span class="fl">1.2</span>] }<span class="op">,</span></span>
<span id="cb4-294"><a href="#cb4-294" aria-hidden="true" tabindex="-1"></a>  <span class="dt">width</span><span class="op">:</span> <span class="dv">640</span><span class="op">,</span></span>
<span id="cb4-295"><a href="#cb4-295" aria-hidden="true" tabindex="-1"></a>  <span class="dt">height</span><span class="op">:</span> <span class="dv">240</span><span class="op">,</span></span>
<span id="cb4-296"><a href="#cb4-296" aria-hidden="true" tabindex="-1"></a>  <span class="dt">marks</span><span class="op">:</span> [</span>
<span id="cb4-297"><a href="#cb4-297" aria-hidden="true" tabindex="-1"></a>    Plot<span class="op">.</span><span class="fu">line</span>(</span>
<span id="cb4-298"><a href="#cb4-298" aria-hidden="true" tabindex="-1"></a>      d3</span>
<span id="cb4-299"><a href="#cb4-299" aria-hidden="true" tabindex="-1"></a>        <span class="op">.</span><span class="fu">range</span>(<span class="op">-</span>xmgauss<span class="op">,</span> xmgauss<span class="op">,</span> <span class="fl">0.01</span>)</span>
<span id="cb4-300"><a href="#cb4-300" aria-hidden="true" tabindex="-1"></a>        <span class="op">.</span><span class="fu">map</span>(t <span class="kw">=&gt;</span> [t<span class="op">,</span> <span class="fu">gauss</span>(t<span class="op">,</span>mu<span class="op">,</span>sigma)])<span class="op">,</span>{</span>
<span id="cb4-301"><a href="#cb4-301" aria-hidden="true" tabindex="-1"></a>        <span class="dt">strokeWidth</span><span class="op">:</span> <span class="dv">3</span><span class="op">,</span></span>
<span id="cb4-302"><a href="#cb4-302" aria-hidden="true" tabindex="-1"></a>        <span class="dt">stroke</span><span class="op">:</span> <span class="st">"steelblue"</span></span>
<span id="cb4-303"><a href="#cb4-303" aria-hidden="true" tabindex="-1"></a>      }</span>
<span id="cb4-304"><a href="#cb4-304" aria-hidden="true" tabindex="-1"></a>    )<span class="op">,</span></span>
<span id="cb4-305"><a href="#cb4-305" aria-hidden="true" tabindex="-1"></a>      Plot<span class="op">.</span><span class="fu">ruleX</span>([<span class="dv">0</span>])<span class="op">,</span></span>
<span id="cb4-306"><a href="#cb4-306" aria-hidden="true" tabindex="-1"></a>      Plot<span class="op">.</span><span class="fu">ruleY</span>([<span class="dv">0</span>])<span class="op">,</span></span>
<span id="cb4-307"><a href="#cb4-307" aria-hidden="true" tabindex="-1"></a>      Plot<span class="op">.</span><span class="fu">axisX</span>({ <span class="dt">y</span><span class="op">:</span> <span class="dv">0</span> })<span class="op">,</span></span>
<span id="cb4-308"><a href="#cb4-308" aria-hidden="true" tabindex="-1"></a>      Plot<span class="op">.</span><span class="fu">axisY</span>({ <span class="dt">x</span><span class="op">:</span> <span class="dv">0</span> })</span>
<span id="cb4-309"><a href="#cb4-309" aria-hidden="true" tabindex="-1"></a>  ]</span>
<span id="cb4-310"><a href="#cb4-310" aria-hidden="true" tabindex="-1"></a>})</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div id="fig-normal" class="quarto-figure quarto-figure-center anchored">
<figure class="quarto-float quarto-float-fig figure">
<div aria-describedby="fig-normal-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
<div class="cell">
<div class="cell-output cell-output-display">
<div>
<div id="ojs-cell-4-1" data-nodetype="declaration">

</div>
</div>
</div>
<div class="cell-output cell-output-display">
<div>
<div id="ojs-cell-4-2" data-nodetype="declaration">

</div>
</div>
</div>
<div class="cell-output cell-output-display">
<div>
<div id="ojs-cell-4-3" data-nodetype="declaration">

</div>
</div>
</div>
<div class="cell-output cell-output-display">
<div>
<div id="ojs-cell-4-4" data-nodetype="declaration">

</div>
</div>
</div>
<div class="cell-output cell-output-display">
<div>
<div id="ojs-cell-4-5" data-nodetype="declaration">

</div>
</div>
</div>
<div class="cell-output cell-output-display">
<div>
<div id="ojs-cell-4-6" data-nodetype="expression">

</div>
</div>
</div>
</div>
</div>
<figcaption class="figure quarto-float-caption quarto-float-fig" id="fig-normal-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
Figure&nbsp;1.3: Graph of <span class="math inline">\(f_X(x)=\dfrac1{\sigma\sqrt{2\pi}}e^{-\frac1{2\sigma^2}(x-\mu)^2}\)</span>
</figcaption>
</figure>
</div>
<div class="callout callout-style-default callout-note no-icon callout-titled">
<div class="callout-header d-flex align-content-center">
<div class="callout-icon-container">
<i class="callout-icon no-icon"></i>
</div>
<div class="callout-title-container flex-fill">
1.7 The lognormal distribution
</div>
</div>
<div class="callout-body-container callout-body">
<p>A random variable <span class="math inline">\(X:\Omega\to{(0,\infty)}\)</span> has the <strong>lognormal distribution</strong> with parameters <span class="math inline">\(\mu\)</span> and <span class="math inline">\(\sigma^2\)</span> iff <span id="eq-1.23"><span class="math display">\[
\ln X \sim N(\mu,\sigma^2).
\tag{1.23}\]</span></span> Equivalently, if <span class="math inline">\(Z\sim N(\mu,\sigma^2)\)</span>, then <span class="math inline">\(X=e^Z\)</span>.</p>
<p>Notation: <span class="math display">\[
X\sim\ln N (\mu,\sigma^2).
\]</span></p>
<p>Then <span id="eq-1.24"><span class="math display">\[
\mathbb{E}(X)= e^{\mu+\frac12\sigma^2},
\tag{1.24}\]</span></span> <span id="eq-1.25"><span class="math display">\[
\mathrm{Var}(X)=e^{2\mu+\sigma^2}\left( e^{\sigma^2} -1\right),
\tag{1.25}\]</span></span> <span id="eq-1.26"><span class="math display">\[
f_X(x)= \frac{1}{x\sigma\sqrt{2\pi}}\exp\biggl(- \frac{(\ln x -\mu)^2}{2\sigma^2}\biggr)
\tag{1.26}\]</span></span></p>
</div>
</div>
<div class="sourceCode cell-code hidden" id="cb5" data-startfrom="353" data-source-offset="-0"><pre class="sourceCode js code-with-copy"><code class="sourceCode javascript" style="counter-reset: source-line 352;"><span id="cb5-353"><a href="#cb5-353" aria-hidden="true" tabindex="-1"></a>viewof mu2 <span class="op">=</span> Inputs<span class="op">.</span><span class="fu">range</span>([<span class="dv">0</span><span class="op">,</span> xmloggauss<span class="op">*</span><span class="fl">0.5</span>]<span class="op">,</span> { <span class="dt">value</span><span class="op">:</span> <span class="dv">0</span><span class="op">,</span> <span class="dt">step</span><span class="op">:</span> <span class="fl">0.001</span><span class="op">,</span> <span class="dt">label</span><span class="op">:</span> <span class="fu">tex</span><span class="vs">`</span><span class="sc">\m</span><span class="vs">u:`</span> })</span>
<span id="cb5-354"><a href="#cb5-354" aria-hidden="true" tabindex="-1"></a>viewof sigma2 <span class="op">=</span> Inputs<span class="op">.</span><span class="fu">range</span>([<span class="fl">0.1</span><span class="op">,</span> <span class="dv">10</span>]<span class="op">,</span> { <span class="dt">value</span><span class="op">:</span> <span class="dv">1</span><span class="op">,</span> <span class="dt">step</span><span class="op">:</span> <span class="fl">0.001</span><span class="op">,</span> <span class="dt">label</span><span class="op">:</span> <span class="fu">tex</span><span class="vs">`</span><span class="sc">\s</span><span class="vs">igma:`</span> })</span>
<span id="cb5-355"><a href="#cb5-355" aria-hidden="true" tabindex="-1"></a>viewof xmloggauss <span class="op">=</span> Inputs<span class="op">.</span><span class="fu">range</span>([<span class="dv">1</span><span class="op">,</span> <span class="dv">100</span>]<span class="op">,</span> { <span class="dt">value</span><span class="op">:</span> <span class="dv">10</span><span class="op">,</span> <span class="dt">step</span><span class="op">:</span> <span class="dv">1</span><span class="op">,</span> <span class="dt">label</span><span class="op">:</span> <span class="fu">tex</span><span class="vs">`x_</span><span class="sc">\m</span><span class="vs">athrm{max}`</span> })</span>
<span id="cb5-356"><a href="#cb5-356" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb5-357"><a href="#cb5-357" aria-hidden="true" tabindex="-1"></a><span class="kw">function</span> <span class="fu">loggauss</span>(t<span class="op">,</span>mu<span class="op">,</span>sigma){</span>
<span id="cb5-358"><a href="#cb5-358" aria-hidden="true" tabindex="-1"></a>  <span class="cf">return</span> <span class="bu">Math</span><span class="op">.</span><span class="fu">exp</span>(<span class="op">-</span>(<span class="dv">1</span><span class="op">/</span>(<span class="dv">2</span><span class="op">*</span>sigma<span class="op">**</span><span class="dv">2</span>))<span class="op">*</span>(<span class="bu">Math</span><span class="op">.</span><span class="fu">log</span>(t)<span class="op">-</span>mu)<span class="op">**</span><span class="dv">2</span>)<span class="op">/</span>(t<span class="op">*</span>sigma<span class="op">*</span><span class="bu">Math</span><span class="op">.</span><span class="fu">sqrt</span>(<span class="dv">2</span><span class="op">*</span><span class="bu">Math</span><span class="op">.</span><span class="cn">PI</span>))<span class="op">;</span></span>
<span id="cb5-359"><a href="#cb5-359" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb5-360"><a href="#cb5-360" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb5-361"><a href="#cb5-361" aria-hidden="true" tabindex="-1"></a>ymaxloggauss <span class="op">=</span> d3<span class="op">.</span><span class="fu">max</span>(d3<span class="op">.</span><span class="fu">range</span>(<span class="fl">0.01</span><span class="op">,</span> xmloggauss<span class="op">,</span> <span class="fl">0.001</span>)<span class="op">.</span><span class="fu">map</span>(t <span class="kw">=&gt;</span> <span class="fu">loggauss</span>(t<span class="op">,</span>mu2<span class="op">,</span>sigma2)))</span>
<span id="cb5-362"><a href="#cb5-362" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb5-363"><a href="#cb5-363" aria-hidden="true" tabindex="-1"></a>Plot<span class="op">.</span><span class="fu">plot</span>({</span>
<span id="cb5-364"><a href="#cb5-364" aria-hidden="true" tabindex="-1"></a>  <span class="dt">x</span><span class="op">:</span> { <span class="dt">domain</span><span class="op">:</span> [<span class="fl">0.1</span><span class="op">,</span>xmloggauss] }<span class="op">,</span></span>
<span id="cb5-365"><a href="#cb5-365" aria-hidden="true" tabindex="-1"></a>  <span class="dt">y</span><span class="op">:</span> { <span class="dt">domain</span><span class="op">:</span> [<span class="op">-</span>ymaxloggauss<span class="op">*</span><span class="fl">0.1</span><span class="op">,</span>  ymaxloggauss<span class="op">*</span><span class="fl">1.2</span>] }<span class="op">,</span></span>
<span id="cb5-366"><a href="#cb5-366" aria-hidden="true" tabindex="-1"></a>  <span class="dt">width</span><span class="op">:</span> <span class="dv">640</span><span class="op">,</span></span>
<span id="cb5-367"><a href="#cb5-367" aria-hidden="true" tabindex="-1"></a>  <span class="dt">height</span><span class="op">:</span> <span class="dv">240</span><span class="op">,</span></span>
<span id="cb5-368"><a href="#cb5-368" aria-hidden="true" tabindex="-1"></a>  <span class="dt">marks</span><span class="op">:</span> [</span>
<span id="cb5-369"><a href="#cb5-369" aria-hidden="true" tabindex="-1"></a>    Plot<span class="op">.</span><span class="fu">line</span>(</span>
<span id="cb5-370"><a href="#cb5-370" aria-hidden="true" tabindex="-1"></a>      d3</span>
<span id="cb5-371"><a href="#cb5-371" aria-hidden="true" tabindex="-1"></a>        <span class="op">.</span><span class="fu">range</span>(<span class="fl">0.1</span><span class="op">,</span> xmloggauss<span class="op">,</span> <span class="fl">0.01</span>)</span>
<span id="cb5-372"><a href="#cb5-372" aria-hidden="true" tabindex="-1"></a>        <span class="op">.</span><span class="fu">map</span>(t <span class="kw">=&gt;</span> [t<span class="op">,</span> <span class="fu">loggauss</span>(t<span class="op">,</span>mu2<span class="op">,</span>sigma2)])<span class="op">,</span>{</span>
<span id="cb5-373"><a href="#cb5-373" aria-hidden="true" tabindex="-1"></a>        <span class="dt">strokeWidth</span><span class="op">:</span> <span class="dv">3</span><span class="op">,</span></span>
<span id="cb5-374"><a href="#cb5-374" aria-hidden="true" tabindex="-1"></a>        <span class="dt">stroke</span><span class="op">:</span> <span class="st">"steelblue"</span></span>
<span id="cb5-375"><a href="#cb5-375" aria-hidden="true" tabindex="-1"></a>      }</span>
<span id="cb5-376"><a href="#cb5-376" aria-hidden="true" tabindex="-1"></a>    )<span class="op">,</span></span>
<span id="cb5-377"><a href="#cb5-377" aria-hidden="true" tabindex="-1"></a>      Plot<span class="op">.</span><span class="fu">ruleX</span>([<span class="dv">0</span>])<span class="op">,</span></span>
<span id="cb5-378"><a href="#cb5-378" aria-hidden="true" tabindex="-1"></a>      Plot<span class="op">.</span><span class="fu">ruleY</span>([<span class="dv">0</span>])<span class="op">,</span></span>
<span id="cb5-379"><a href="#cb5-379" aria-hidden="true" tabindex="-1"></a>      Plot<span class="op">.</span><span class="fu">axisX</span>({ <span class="dt">y</span><span class="op">:</span> <span class="dv">0</span> })<span class="op">,</span></span>
<span id="cb5-380"><a href="#cb5-380" aria-hidden="true" tabindex="-1"></a>      Plot<span class="op">.</span><span class="fu">axisY</span>({ <span class="dt">x</span><span class="op">:</span> <span class="dv">0</span> })</span>
<span id="cb5-381"><a href="#cb5-381" aria-hidden="true" tabindex="-1"></a>  ]</span>
<span id="cb5-382"><a href="#cb5-382" aria-hidden="true" tabindex="-1"></a>})</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div id="fig-lognormal" class="quarto-figure quarto-figure-center anchored">
<figure class="quarto-float quarto-float-fig figure">
<div aria-describedby="fig-lognormal-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
<div class="cell">
<div class="cell-output cell-output-display">
<div>
<div id="ojs-cell-5-1" data-nodetype="declaration">

</div>
</div>
</div>
<div class="cell-output cell-output-display">
<div>
<div id="ojs-cell-5-2" data-nodetype="declaration">

</div>
</div>
</div>
<div class="cell-output cell-output-display">
<div>
<div id="ojs-cell-5-3" data-nodetype="declaration">

</div>
</div>
</div>
<div class="cell-output cell-output-display">
<div>
<div id="ojs-cell-5-4" data-nodetype="declaration">

</div>
</div>
</div>
<div class="cell-output cell-output-display">
<div>
<div id="ojs-cell-5-5" data-nodetype="declaration">

</div>
</div>
</div>
<div class="cell-output cell-output-display">
<div>
<div id="ojs-cell-5-6" data-nodetype="expression">

</div>
</div>
</div>
</div>
</div>
<figcaption class="figure quarto-float-caption quarto-float-fig" id="fig-lognormal-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
Figure&nbsp;1.4: Graph of <span class="math inline">\(f_X(x)= \dfrac{1}{x\sigma\sqrt{2\pi}}\exp\biggl(- \frac{(\ln x -\mu)^2}{2\sigma^2}\biggr)\)</span>
</figcaption>
</figure>
</div>
<div class="callout callout-style-default callout-note no-icon callout-titled">
<div class="callout-header d-flex align-content-center">
<div class="callout-icon-container">
<i class="callout-icon no-icon"></i>
</div>
<div class="callout-title-container flex-fill">
1.8 Pareto distribution
</div>
</div>
<div class="callout-body-container callout-body">
<p>A random variable <span class="math inline">\(X\)</span> has the two-parameter Pareto distribution with parameters <span class="math inline">\(\alpha&gt;0\)</span> and <span class="math inline">\(\lambda&gt;0\)</span>, if <span id="eq-1.27"><span class="math display">\[
F_X(x)=1-\biggl(\frac{\lambda}{\lambda+x}\biggr)^\alpha, \qquad x\geq0.
\tag{1.27}\]</span></span> Notation <span class="math inline">\(X\sim Pa(\alpha,\lambda)\)</span>.</p>
<p>Then <span id="eq-1.28"><span class="math display">\[
f_X(x)=\frac{\alpha\lambda^\alpha}{(\lambda+x)^{\alpha+1}},
\tag{1.28}\]</span></span> and, {for <span class="math inline">\(\alpha&gt;1\)</span>}, <span id="eq-1.29"><span class="math display">\[
\mathbb{E}(X)=\frac{\lambda}{\alpha-1}
\tag{1.29}\]</span></span> A modification of the Pareto distribution is the Burr distribution with additional parameter <span class="math inline">\(\gamma&gt;0\)</span> <span id="eq-1.30"><span class="math display">\[
F_{Burr}(x)=F_{Pareto}(x^\gamma)=1-\biggl(\frac{\lambda}{\lambda+x^\gamma}\biggr)^\alpha.
\tag{1.30}\]</span></span></p>
</div>
</div>
<div class="sourceCode cell-code hidden" id="cb6" data-startfrom="422" data-source-offset="-0"><pre class="sourceCode js code-with-copy"><code class="sourceCode javascript" style="counter-reset: source-line 421;"><span id="cb6-422"><a href="#cb6-422" aria-hidden="true" tabindex="-1"></a>viewof ap <span class="op">=</span> Inputs<span class="op">.</span><span class="fu">range</span>([<span class="fl">0.1</span><span class="op">,</span> <span class="dv">10</span>]<span class="op">,</span> { <span class="dt">value</span><span class="op">:</span> <span class="fl">0.1</span><span class="op">,</span> <span class="dt">step</span><span class="op">:</span> <span class="fl">0.001</span><span class="op">,</span> <span class="dt">label</span><span class="op">:</span> <span class="fu">tex</span><span class="vs">`</span><span class="sc">\a</span><span class="vs">lpha:`</span> })</span>
<span id="cb6-423"><a href="#cb6-423" aria-hidden="true" tabindex="-1"></a>viewof lp <span class="op">=</span> Inputs<span class="op">.</span><span class="fu">range</span>([<span class="fl">0.1</span><span class="op">,</span> <span class="dv">10</span>]<span class="op">,</span> { <span class="dt">value</span><span class="op">:</span> <span class="fl">0.1</span><span class="op">,</span> <span class="dt">step</span><span class="op">:</span> <span class="fl">0.001</span><span class="op">,</span> <span class="dt">label</span><span class="op">:</span> <span class="fu">tex</span><span class="vs">`</span><span class="sc">\l</span><span class="vs">ambda:`</span> })</span>
<span id="cb6-424"><a href="#cb6-424" aria-hidden="true" tabindex="-1"></a>viewof xmpareto <span class="op">=</span> Inputs<span class="op">.</span><span class="fu">range</span>([<span class="dv">1</span><span class="op">,</span> <span class="dv">100</span>]<span class="op">,</span> { <span class="dt">value</span><span class="op">:</span> <span class="dv">10</span><span class="op">,</span> <span class="dt">step</span><span class="op">:</span> <span class="dv">1</span><span class="op">,</span> <span class="dt">label</span><span class="op">:</span> <span class="fu">tex</span><span class="vs">`x_</span><span class="sc">\m</span><span class="vs">athrm{max}`</span> })</span>
<span id="cb6-425"><a href="#cb6-425" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb6-426"><a href="#cb6-426" aria-hidden="true" tabindex="-1"></a><span class="kw">function</span> <span class="fu">pareto</span>(t<span class="op">,</span>alpha<span class="op">,</span>lambda){</span>
<span id="cb6-427"><a href="#cb6-427" aria-hidden="true" tabindex="-1"></a>  <span class="cf">return</span> alpha<span class="op">*</span>lambda<span class="op">**</span>alpha<span class="op">*</span>(t<span class="op">+</span>lambda)<span class="op">**</span>(<span class="op">-</span><span class="dv">1</span><span class="op">-</span>alpha)<span class="op">;</span></span>
<span id="cb6-428"><a href="#cb6-428" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb6-429"><a href="#cb6-429" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb6-430"><a href="#cb6-430" aria-hidden="true" tabindex="-1"></a>ymaxpareto <span class="op">=</span> d3<span class="op">.</span><span class="fu">max</span>(d3<span class="op">.</span><span class="fu">range</span>(<span class="fl">0.1</span><span class="op">,</span> xmpareto<span class="op">,</span> <span class="fl">0.01</span>)<span class="op">.</span><span class="fu">map</span>(t <span class="kw">=&gt;</span> <span class="fu">pareto</span>(t<span class="op">,</span>ap<span class="op">,</span>lp)))</span>
<span id="cb6-431"><a href="#cb6-431" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb6-432"><a href="#cb6-432" aria-hidden="true" tabindex="-1"></a>Plot<span class="op">.</span><span class="fu">plot</span>({</span>
<span id="cb6-433"><a href="#cb6-433" aria-hidden="true" tabindex="-1"></a>  <span class="dt">x</span><span class="op">:</span> { <span class="dt">domain</span><span class="op">:</span> [<span class="fl">0.1</span><span class="op">,</span>xmpareto] }<span class="op">,</span></span>
<span id="cb6-434"><a href="#cb6-434" aria-hidden="true" tabindex="-1"></a>  <span class="dt">y</span><span class="op">:</span> { <span class="dt">domain</span><span class="op">:</span> [<span class="op">-</span>ymaxpareto<span class="op">*</span><span class="fl">0.1</span><span class="op">,</span>  ymaxpareto<span class="op">*</span><span class="fl">1.2</span>] }<span class="op">,</span></span>
<span id="cb6-435"><a href="#cb6-435" aria-hidden="true" tabindex="-1"></a>  <span class="dt">width</span><span class="op">:</span> <span class="dv">640</span><span class="op">,</span></span>
<span id="cb6-436"><a href="#cb6-436" aria-hidden="true" tabindex="-1"></a>  <span class="dt">height</span><span class="op">:</span> <span class="dv">240</span><span class="op">,</span></span>
<span id="cb6-437"><a href="#cb6-437" aria-hidden="true" tabindex="-1"></a>  <span class="dt">marks</span><span class="op">:</span> [</span>
<span id="cb6-438"><a href="#cb6-438" aria-hidden="true" tabindex="-1"></a>    Plot<span class="op">.</span><span class="fu">line</span>(</span>
<span id="cb6-439"><a href="#cb6-439" aria-hidden="true" tabindex="-1"></a>      d3</span>
<span id="cb6-440"><a href="#cb6-440" aria-hidden="true" tabindex="-1"></a>        <span class="op">.</span><span class="fu">range</span>(<span class="fl">0.1</span><span class="op">,</span> xmpareto<span class="op">,</span> <span class="fl">0.01</span>)</span>
<span id="cb6-441"><a href="#cb6-441" aria-hidden="true" tabindex="-1"></a>        <span class="op">.</span><span class="fu">map</span>(t <span class="kw">=&gt;</span> [t<span class="op">,</span> <span class="fu">pareto</span>(t<span class="op">,</span>ap<span class="op">,</span>lp)])<span class="op">,</span>{</span>
<span id="cb6-442"><a href="#cb6-442" aria-hidden="true" tabindex="-1"></a>        <span class="dt">strokeWidth</span><span class="op">:</span> <span class="dv">3</span><span class="op">,</span></span>
<span id="cb6-443"><a href="#cb6-443" aria-hidden="true" tabindex="-1"></a>        <span class="dt">stroke</span><span class="op">:</span> <span class="st">"steelblue"</span></span>
<span id="cb6-444"><a href="#cb6-444" aria-hidden="true" tabindex="-1"></a>      }</span>
<span id="cb6-445"><a href="#cb6-445" aria-hidden="true" tabindex="-1"></a>    )<span class="op">,</span></span>
<span id="cb6-446"><a href="#cb6-446" aria-hidden="true" tabindex="-1"></a>      Plot<span class="op">.</span><span class="fu">ruleX</span>([<span class="dv">0</span>])<span class="op">,</span></span>
<span id="cb6-447"><a href="#cb6-447" aria-hidden="true" tabindex="-1"></a>      Plot<span class="op">.</span><span class="fu">ruleY</span>([<span class="dv">0</span>])<span class="op">,</span></span>
<span id="cb6-448"><a href="#cb6-448" aria-hidden="true" tabindex="-1"></a>      Plot<span class="op">.</span><span class="fu">axisX</span>({ <span class="dt">y</span><span class="op">:</span> <span class="dv">0</span> })<span class="op">,</span></span>
<span id="cb6-449"><a href="#cb6-449" aria-hidden="true" tabindex="-1"></a>      Plot<span class="op">.</span><span class="fu">axisY</span>({ <span class="dt">x</span><span class="op">:</span> <span class="dv">0</span> })</span>
<span id="cb6-450"><a href="#cb6-450" aria-hidden="true" tabindex="-1"></a>  ]</span>
<span id="cb6-451"><a href="#cb6-451" aria-hidden="true" tabindex="-1"></a>})</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div id="fig-pareto" class="quarto-figure quarto-figure-center anchored">
<figure class="quarto-float quarto-float-fig figure">
<div aria-describedby="fig-pareto-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
<div class="cell">
<div class="cell-output cell-output-display">
<div>
<div id="ojs-cell-6-1" data-nodetype="declaration">

</div>
</div>
</div>
<div class="cell-output cell-output-display">
<div>
<div id="ojs-cell-6-2" data-nodetype="declaration">

</div>
</div>
</div>
<div class="cell-output cell-output-display">
<div>
<div id="ojs-cell-6-3" data-nodetype="declaration">

</div>
</div>
</div>
<div class="cell-output cell-output-display">
<div>
<div id="ojs-cell-6-4" data-nodetype="declaration">

</div>
</div>
</div>
<div class="cell-output cell-output-display">
<div>
<div id="ojs-cell-6-5" data-nodetype="declaration">

</div>
</div>
</div>
<div class="cell-output cell-output-display">
<div>
<div id="ojs-cell-6-6" data-nodetype="expression">

</div>
</div>
</div>
</div>
</div>
<figcaption class="figure quarto-float-caption quarto-float-fig" id="fig-pareto-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
Figure&nbsp;1.5: Graph of <span class="math inline">\(f_X(x)= \dfrac{\alpha\lambda^\alpha}{(\lambda+x)^{\alpha+1}}\)</span>
</figcaption>
</figure>
</div>
<div class="callout callout-style-default callout-note no-icon callout-titled">
<div class="callout-header d-flex align-content-center">
<div class="callout-icon-container">
<i class="callout-icon no-icon"></i>
</div>
<div class="callout-title-container flex-fill">
1.14 The Weibull distribution
</div>
</div>
<div class="callout-body-container callout-body">
<p>For <span class="math inline">\(a&gt;0\)</span>, <span class="math inline">\(b&gt;0\)</span>, we denote <span class="math inline">\(X\sim W(a,b)\)</span> iff <span id="eq-1.31"><span class="math display">\[
F_X(x)=1-e^{-a x^b},
\tag{1.31}\]</span></span> <span id="eq-1.32"><span class="math display">\[
f_X(x)=ab x^{b-1}e^{-a x^b},
\tag{1.32}\]</span></span> <span id="eq-1.33"><span class="math display">\[
\mathbb{E}(X)=\Gamma\biggl(1+\frac{1}{b}\biggr)a^{-\frac{1}{b}}.
\tag{1.33}\]</span></span></p>
</div>
</div>
<div class="sourceCode cell-code hidden" id="cb7" data-startfrom="482" data-source-offset="-0"><pre class="sourceCode js code-with-copy"><code class="sourceCode javascript" style="counter-reset: source-line 481;"><span id="cb7-482"><a href="#cb7-482" aria-hidden="true" tabindex="-1"></a>viewof aw <span class="op">=</span> Inputs<span class="op">.</span><span class="fu">range</span>([<span class="fl">0.1</span><span class="op">,</span> <span class="dv">10</span>]<span class="op">,</span> { <span class="dt">value</span><span class="op">:</span> <span class="fl">0.1</span><span class="op">,</span> <span class="dt">step</span><span class="op">:</span> <span class="fl">0.001</span><span class="op">,</span> <span class="dt">label</span><span class="op">:</span> <span class="fu">tex</span><span class="vs">`a:`</span> })</span>
<span id="cb7-483"><a href="#cb7-483" aria-hidden="true" tabindex="-1"></a>viewof bw <span class="op">=</span> Inputs<span class="op">.</span><span class="fu">range</span>([<span class="fl">0.1</span><span class="op">,</span> <span class="dv">10</span>]<span class="op">,</span> { <span class="dt">value</span><span class="op">:</span> <span class="fl">0.1</span><span class="op">,</span> <span class="dt">step</span><span class="op">:</span> <span class="fl">0.001</span><span class="op">,</span> <span class="dt">label</span><span class="op">:</span> <span class="fu">tex</span><span class="vs">`b:`</span> })</span>
<span id="cb7-484"><a href="#cb7-484" aria-hidden="true" tabindex="-1"></a>viewof xmweibull <span class="op">=</span> Inputs<span class="op">.</span><span class="fu">range</span>([<span class="dv">1</span><span class="op">,</span> <span class="dv">100</span>]<span class="op">,</span> { <span class="dt">value</span><span class="op">:</span> <span class="dv">10</span><span class="op">,</span> <span class="dt">step</span><span class="op">:</span> <span class="dv">1</span><span class="op">,</span> <span class="dt">label</span><span class="op">:</span> <span class="fu">tex</span><span class="vs">`x_</span><span class="sc">\m</span><span class="vs">athrm{max}`</span> })</span>
<span id="cb7-485"><a href="#cb7-485" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb7-486"><a href="#cb7-486" aria-hidden="true" tabindex="-1"></a><span class="kw">function</span> <span class="fu">weibull</span>(t<span class="op">,</span>a<span class="op">,</span>b){</span>
<span id="cb7-487"><a href="#cb7-487" aria-hidden="true" tabindex="-1"></a>  <span class="cf">return</span> a<span class="op">*</span>b<span class="op">*</span>t<span class="op">**</span>(b<span class="op">-</span><span class="dv">1</span>)<span class="op">*</span><span class="bu">Math</span><span class="op">.</span><span class="fu">exp</span>(<span class="op">-</span>a<span class="op">*</span>t<span class="op">**</span>b)<span class="op">;</span></span>
<span id="cb7-488"><a href="#cb7-488" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb7-489"><a href="#cb7-489" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb7-490"><a href="#cb7-490" aria-hidden="true" tabindex="-1"></a>ymaxweibull <span class="op">=</span> d3<span class="op">.</span><span class="fu">max</span>(d3<span class="op">.</span><span class="fu">range</span>(<span class="fl">0.1</span><span class="op">,</span> xmweibull<span class="op">,</span> <span class="fl">0.01</span>)<span class="op">.</span><span class="fu">map</span>(t <span class="kw">=&gt;</span> <span class="fu">weibull</span>(t<span class="op">,</span>aw<span class="op">,</span>bw)))</span>
<span id="cb7-491"><a href="#cb7-491" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb7-492"><a href="#cb7-492" aria-hidden="true" tabindex="-1"></a>Plot<span class="op">.</span><span class="fu">plot</span>({</span>
<span id="cb7-493"><a href="#cb7-493" aria-hidden="true" tabindex="-1"></a>  <span class="dt">x</span><span class="op">:</span> { <span class="dt">domain</span><span class="op">:</span> [<span class="fl">0.1</span><span class="op">,</span>xmweibull] }<span class="op">,</span></span>
<span id="cb7-494"><a href="#cb7-494" aria-hidden="true" tabindex="-1"></a>  <span class="dt">y</span><span class="op">:</span> { <span class="dt">domain</span><span class="op">:</span> [<span class="op">-</span>ymaxweibull<span class="op">*</span><span class="fl">0.1</span><span class="op">,</span>  ymaxweibull<span class="op">*</span><span class="fl">1.2</span>] }<span class="op">,</span></span>
<span id="cb7-495"><a href="#cb7-495" aria-hidden="true" tabindex="-1"></a>  <span class="dt">width</span><span class="op">:</span> <span class="dv">640</span><span class="op">,</span></span>
<span id="cb7-496"><a href="#cb7-496" aria-hidden="true" tabindex="-1"></a>  <span class="dt">height</span><span class="op">:</span> <span class="dv">240</span><span class="op">,</span></span>
<span id="cb7-497"><a href="#cb7-497" aria-hidden="true" tabindex="-1"></a>  <span class="dt">marks</span><span class="op">:</span> [</span>
<span id="cb7-498"><a href="#cb7-498" aria-hidden="true" tabindex="-1"></a>    Plot<span class="op">.</span><span class="fu">line</span>(</span>
<span id="cb7-499"><a href="#cb7-499" aria-hidden="true" tabindex="-1"></a>      d3</span>
<span id="cb7-500"><a href="#cb7-500" aria-hidden="true" tabindex="-1"></a>        <span class="op">.</span><span class="fu">range</span>(<span class="fl">0.1</span><span class="op">,</span> xmweibull<span class="op">,</span> <span class="fl">0.01</span>)</span>
<span id="cb7-501"><a href="#cb7-501" aria-hidden="true" tabindex="-1"></a>        <span class="op">.</span><span class="fu">map</span>(t <span class="kw">=&gt;</span> [t<span class="op">,</span>  <span class="fu">weibull</span>(t<span class="op">,</span>aw<span class="op">,</span>bw)])<span class="op">,</span>{</span>
<span id="cb7-502"><a href="#cb7-502" aria-hidden="true" tabindex="-1"></a>        <span class="dt">strokeWidth</span><span class="op">:</span> <span class="dv">3</span><span class="op">,</span></span>
<span id="cb7-503"><a href="#cb7-503" aria-hidden="true" tabindex="-1"></a>        <span class="dt">stroke</span><span class="op">:</span> <span class="st">"steelblue"</span></span>
<span id="cb7-504"><a href="#cb7-504" aria-hidden="true" tabindex="-1"></a>      }</span>
<span id="cb7-505"><a href="#cb7-505" aria-hidden="true" tabindex="-1"></a>    )<span class="op">,</span></span>
<span id="cb7-506"><a href="#cb7-506" aria-hidden="true" tabindex="-1"></a>      Plot<span class="op">.</span><span class="fu">ruleX</span>([<span class="dv">0</span>])<span class="op">,</span></span>
<span id="cb7-507"><a href="#cb7-507" aria-hidden="true" tabindex="-1"></a>      Plot<span class="op">.</span><span class="fu">ruleY</span>([<span class="dv">0</span>])<span class="op">,</span></span>
<span id="cb7-508"><a href="#cb7-508" aria-hidden="true" tabindex="-1"></a>      Plot<span class="op">.</span><span class="fu">axisX</span>({ <span class="dt">y</span><span class="op">:</span> <span class="dv">0</span> })<span class="op">,</span></span>
<span id="cb7-509"><a href="#cb7-509" aria-hidden="true" tabindex="-1"></a>      Plot<span class="op">.</span><span class="fu">axisY</span>({ <span class="dt">x</span><span class="op">:</span> <span class="dv">0</span> })</span>
<span id="cb7-510"><a href="#cb7-510" aria-hidden="true" tabindex="-1"></a>  ]</span>
<span id="cb7-511"><a href="#cb7-511" aria-hidden="true" tabindex="-1"></a>})</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div id="fig-weibull" class="quarto-figure quarto-figure-center anchored">
<figure class="quarto-float quarto-float-fig figure">
<div aria-describedby="fig-weibull-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
<div class="cell">
<div class="cell-output cell-output-display">
<div>
<div id="ojs-cell-7-1" data-nodetype="declaration">

</div>
</div>
</div>
<div class="cell-output cell-output-display">
<div>
<div id="ojs-cell-7-2" data-nodetype="declaration">

</div>
</div>
</div>
<div class="cell-output cell-output-display">
<div>
<div id="ojs-cell-7-3" data-nodetype="declaration">

</div>
</div>
</div>
<div class="cell-output cell-output-display">
<div>
<div id="ojs-cell-7-4" data-nodetype="declaration">

</div>
</div>
</div>
<div class="cell-output cell-output-display">
<div>
<div id="ojs-cell-7-5" data-nodetype="declaration">

</div>
</div>
</div>
<div class="cell-output cell-output-display">
<div>
<div id="ojs-cell-7-6" data-nodetype="expression">

</div>
</div>
</div>
</div>
</div>
<figcaption class="figure quarto-float-caption quarto-float-fig" id="fig-weibull-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
Figure&nbsp;1.6: Graph of <span class="math inline">\(f_X(x)= ab x^{b-1}e^{-a x^b}\)</span>
</figcaption>
</figure>
</div>
<div id="fig-comparison" class="quarto-layout-panel">
<figure class="quarto-float quarto-float-fig figure">
<div aria-describedby="fig-comparison-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
<div class="quarto-layout-row quarto-layout-valign-top">
<div class="quarto-layout-cell" style="flex-basis: 100.0%;justify-content: center;">
<div>

</div>
<div class="quarto-layout-panel" data-layout-ncol="2">
<div class="quarto-layout-row quarto-layout-valign-top">
<div class="cell quarto-layout-cell" style="flex-basis: 50.0%;justify-content: center;">
<div class="sourceCode cell-code hidden" id="cb8" data-startfrom="523" data-source-offset="-0"><pre class="sourceCode js code-with-copy"><code class="sourceCode javascript" style="counter-reset: source-line 522;"><span id="cb8-523"><a href="#cb8-523" aria-hidden="true" tabindex="-1"></a><span class="im">import</span> {legend<span class="op">,</span> swatches} <span class="im">from</span> <span class="st">"@d3/color-legend"</span></span>
<span id="cb8-524"><a href="#cb8-524" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb8-525"><a href="#cb8-525" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb8-526"><a href="#cb8-526" aria-hidden="true" tabindex="-1"></a>viewof xmin <span class="op">=</span> Inputs<span class="op">.</span><span class="fu">range</span>([<span class="fl">0.1</span><span class="op">,</span> xmax<span class="op">*</span><span class="fl">0.9</span>]<span class="op">,</span> { <span class="dt">value</span><span class="op">:</span> <span class="fl">0.1</span><span class="op">,</span> <span class="dt">step</span><span class="op">:</span> <span class="fl">0.1</span><span class="op">,</span> <span class="dt">label</span><span class="op">:</span> <span class="fu">tex</span><span class="vs">`x_</span><span class="sc">\m</span><span class="vs">athrm{min}`</span> })</span>
<span id="cb8-527"><a href="#cb8-527" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb8-528"><a href="#cb8-528" aria-hidden="true" tabindex="-1"></a>viewof xmax <span class="op">=</span> Inputs<span class="op">.</span><span class="fu">range</span>([<span class="dv">1</span><span class="op">,</span><span class="dv">1000</span>]<span class="op">,</span> { <span class="dt">value</span><span class="op">:</span> <span class="dv">10</span><span class="op">,</span> <span class="dt">step</span><span class="op">:</span> <span class="dv">1</span><span class="op">,</span> <span class="dt">label</span><span class="op">:</span> <span class="fu">tex</span><span class="vs">`x_</span><span class="sc">\m</span><span class="vs">athrm{max}`</span> })</span>
<span id="cb8-529"><a href="#cb8-529" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb8-530"><a href="#cb8-530" aria-hidden="true" tabindex="-1"></a>viewof lexp <span class="op">=</span> Inputs<span class="op">.</span><span class="fu">range</span>([<span class="fl">0.1</span><span class="op">,</span> <span class="dv">10</span>]<span class="op">,</span> { <span class="dt">value</span><span class="op">:</span> <span class="dv">1</span><span class="op">,</span> <span class="dt">step</span><span class="op">:</span> <span class="fl">0.001</span><span class="op">,</span> <span class="dt">label</span><span class="op">:</span> <span class="fu">tex</span><span class="vs">`</span><span class="sc">\l</span><span class="vs">ambda_{Exp}:`</span> })</span>
<span id="cb8-531"><a href="#cb8-531" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb8-532"><a href="#cb8-532" aria-hidden="true" tabindex="-1"></a>viewof agamma <span class="op">=</span> Inputs<span class="op">.</span><span class="fu">range</span>([<span class="fl">0.1</span><span class="op">,</span> <span class="dv">10</span>]<span class="op">,</span> { <span class="dt">value</span><span class="op">:</span> <span class="dv">1</span><span class="op">,</span> <span class="dt">step</span><span class="op">:</span> <span class="fl">0.001</span><span class="op">,</span> <span class="dt">label</span><span class="op">:</span> <span class="fu">tex</span><span class="vs">`</span><span class="sc">\a</span><span class="vs">lpha_{Gamma}:`</span> })</span>
<span id="cb8-533"><a href="#cb8-533" aria-hidden="true" tabindex="-1"></a>viewof lgamma <span class="op">=</span> Inputs<span class="op">.</span><span class="fu">range</span>([<span class="fl">0.1</span><span class="op">,</span> <span class="dv">10</span>]<span class="op">,</span> { <span class="dt">value</span><span class="op">:</span> <span class="dv">1</span><span class="op">,</span> <span class="dt">step</span><span class="op">:</span> <span class="fl">0.001</span><span class="op">,</span> <span class="dt">label</span><span class="op">:</span> <span class="fu">tex</span><span class="vs">`</span><span class="sc">\l</span><span class="vs">ambda_{Gamma}:`</span> })</span>
<span id="cb8-534"><a href="#cb8-534" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb8-535"><a href="#cb8-535" aria-hidden="true" tabindex="-1"></a>viewof muG <span class="op">=</span> Inputs<span class="op">.</span><span class="fu">range</span>([<span class="fl">0.1</span><span class="op">,</span> <span class="dv">10</span>]<span class="op">,</span> { <span class="dt">value</span><span class="op">:</span> <span class="dv">0</span><span class="op">,</span> <span class="dt">step</span><span class="op">:</span> <span class="fl">0.001</span><span class="op">,</span> <span class="dt">label</span><span class="op">:</span> <span class="fu">tex</span><span class="vs">`</span><span class="sc">\m</span><span class="vs">u_{</span><span class="sc">\m</span><span class="vs">athcal{N}}:`</span> })</span>
<span id="cb8-536"><a href="#cb8-536" aria-hidden="true" tabindex="-1"></a>viewof sigmaG <span class="op">=</span> Inputs<span class="op">.</span><span class="fu">range</span>([<span class="fl">0.1</span><span class="op">,</span> <span class="dv">10</span>]<span class="op">,</span> { <span class="dt">value</span><span class="op">:</span> <span class="dv">1</span><span class="op">,</span> <span class="dt">step</span><span class="op">:</span> <span class="fl">0.001</span><span class="op">,</span> <span class="dt">label</span><span class="op">:</span> <span class="fu">tex</span><span class="vs">`</span><span class="sc">\s</span><span class="vs">igma_{</span><span class="sc">\m</span><span class="vs">athcal{N}}:`</span> })</span>
<span id="cb8-537"><a href="#cb8-537" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb8-538"><a href="#cb8-538" aria-hidden="true" tabindex="-1"></a>viewof logmu <span class="op">=</span> Inputs<span class="op">.</span><span class="fu">range</span>([<span class="fl">0.1</span><span class="op">,</span> <span class="dv">10</span>]<span class="op">,</span> { <span class="dt">value</span><span class="op">:</span> <span class="dv">0</span><span class="op">,</span> <span class="dt">step</span><span class="op">:</span> <span class="fl">0.001</span><span class="op">,</span> <span class="dt">label</span><span class="op">:</span> <span class="fu">tex</span><span class="vs">`</span><span class="sc">\m</span><span class="vs">u_{</span><span class="sc">\l</span><span class="vs">og</span><span class="sc">\m</span><span class="vs">athcal{N}}:`</span> })</span>
<span id="cb8-539"><a href="#cb8-539" aria-hidden="true" tabindex="-1"></a>viewof logsigma <span class="op">=</span> Inputs<span class="op">.</span><span class="fu">range</span>([<span class="fl">0.1</span><span class="op">,</span> <span class="dv">10</span>]<span class="op">,</span> { <span class="dt">value</span><span class="op">:</span> <span class="dv">1</span><span class="op">,</span> <span class="dt">step</span><span class="op">:</span> <span class="fl">0.001</span><span class="op">,</span> <span class="dt">label</span><span class="op">:</span> <span class="fu">tex</span><span class="vs">`</span><span class="sc">\s</span><span class="vs">igma_{</span><span class="sc">\l</span><span class="vs">og</span><span class="sc">\m</span><span class="vs">athcal{N}}:`</span> })</span>
<span id="cb8-540"><a href="#cb8-540" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb8-541"><a href="#cb8-541" aria-hidden="true" tabindex="-1"></a>viewof apareto <span class="op">=</span> Inputs<span class="op">.</span><span class="fu">range</span>([<span class="fl">0.1</span><span class="op">,</span> <span class="dv">10</span>]<span class="op">,</span> { <span class="dt">value</span><span class="op">:</span> <span class="fl">0.1</span><span class="op">,</span> <span class="dt">step</span><span class="op">:</span> <span class="fl">0.001</span><span class="op">,</span> <span class="dt">label</span><span class="op">:</span> <span class="fu">tex</span><span class="vs">`</span><span class="sc">\a</span><span class="vs">lpha_{Pareto}:`</span> })</span>
<span id="cb8-542"><a href="#cb8-542" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb8-543"><a href="#cb8-543" aria-hidden="true" tabindex="-1"></a>viewof lpareto <span class="op">=</span> Inputs<span class="op">.</span><span class="fu">range</span>([<span class="fl">0.1</span><span class="op">,</span> <span class="dv">10</span>]<span class="op">,</span> { <span class="dt">value</span><span class="op">:</span> <span class="fl">0.1</span><span class="op">,</span> <span class="dt">step</span><span class="op">:</span> <span class="fl">0.001</span><span class="op">,</span> <span class="dt">label</span><span class="op">:</span> <span class="fu">tex</span><span class="vs">`</span><span class="sc">\l</span><span class="vs">ambda_{Pareto}:`</span> })</span>
<span id="cb8-544"><a href="#cb8-544" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb8-545"><a href="#cb8-545" aria-hidden="true" tabindex="-1"></a>viewof aweibull <span class="op">=</span> Inputs<span class="op">.</span><span class="fu">range</span>([<span class="fl">0.1</span><span class="op">,</span> <span class="dv">10</span>]<span class="op">,</span> { <span class="dt">value</span><span class="op">:</span> <span class="fl">0.1</span><span class="op">,</span> <span class="dt">step</span><span class="op">:</span> <span class="fl">0.001</span><span class="op">,</span> <span class="dt">label</span><span class="op">:</span> <span class="fu">tex</span><span class="vs">`a_{Weibull}:`</span> })</span>
<span id="cb8-546"><a href="#cb8-546" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb8-547"><a href="#cb8-547" aria-hidden="true" tabindex="-1"></a>viewof bweibull <span class="op">=</span> Inputs<span class="op">.</span><span class="fu">range</span>([<span class="fl">0.1</span><span class="op">,</span> <span class="dv">10</span>]<span class="op">,</span> { <span class="dt">value</span><span class="op">:</span> <span class="fl">0.1</span><span class="op">,</span> <span class="dt">step</span><span class="op">:</span> <span class="fl">0.001</span><span class="op">,</span> <span class="dt">label</span><span class="op">:</span> <span class="fu">tex</span><span class="vs">`b_{Weibull}:`</span> })</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display">
<div>
<div id="ojs-cell-8-1" data-nodetype="declaration">

</div>
</div>
</div>
<div class="cell-output cell-output-display">
<div>
<div id="ojs-cell-8-2" data-nodetype="declaration">

</div>
</div>
</div>
<div class="cell-output cell-output-display">
<div>
<div id="ojs-cell-8-3" data-nodetype="declaration">

</div>
</div>
</div>
<div class="cell-output cell-output-display">
<div>
<div id="ojs-cell-8-4" data-nodetype="declaration">

</div>
</div>
</div>
<div class="cell-output cell-output-display">
<div>
<div id="ojs-cell-8-5" data-nodetype="declaration">

</div>
</div>
</div>
<div class="cell-output cell-output-display">
<div>
<div id="ojs-cell-8-6" data-nodetype="declaration">

</div>
</div>
</div>
<div class="cell-output cell-output-display">
<div>
<div id="ojs-cell-8-7" data-nodetype="declaration">

</div>
</div>
</div>
<div class="cell-output cell-output-display">
<div>
<div id="ojs-cell-8-8" data-nodetype="declaration">

</div>
</div>
</div>
<div class="cell-output cell-output-display">
<div>
<div id="ojs-cell-8-9" data-nodetype="declaration">

</div>
</div>
</div>
<div class="cell-output cell-output-display">
<div>
<div id="ojs-cell-8-10" data-nodetype="declaration">

</div>
</div>
</div>
<div class="cell-output cell-output-display">
<div>
<div id="ojs-cell-8-11" data-nodetype="declaration">

</div>
</div>
</div>
<div class="cell-output cell-output-display">
<div>
<div id="ojs-cell-8-12" data-nodetype="declaration">

</div>
</div>
</div>
<div class="cell-output cell-output-display">
<div>
<div id="ojs-cell-8-13" data-nodetype="declaration">

</div>
</div>
</div>
<div class="cell-output cell-output-display">
<div>
<div id="ojs-cell-8-14" data-nodetype="declaration">

</div>
</div>
</div>
</div>
<div class="cell quarto-layout-cell" style="flex-basis: 50.0%;justify-content: center;">
<div class="sourceCode cell-code hidden" id="cb9" data-startfrom="551" data-source-offset="-0"><pre class="sourceCode js code-with-copy"><code class="sourceCode javascript" style="counter-reset: source-line 550;"><span id="cb9-551"><a href="#cb9-551" aria-hidden="true" tabindex="-1"></a>viewof isExp <span class="op">=</span> Inputs<span class="op">.</span><span class="fu">toggle</span>({<span class="dt">label</span><span class="op">:</span> <span class="st">"exponential"</span><span class="op">,</span><span class="dt">value</span><span class="op">:</span> <span class="kw">true</span>})</span>
<span id="cb9-552"><a href="#cb9-552" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb9-553"><a href="#cb9-553" aria-hidden="true" tabindex="-1"></a>viewof isGamma <span class="op">=</span> Inputs<span class="op">.</span><span class="fu">toggle</span>({<span class="dt">label</span><span class="op">:</span> <span class="st">"gamma"</span><span class="op">,</span><span class="dt">value</span><span class="op">:</span> <span class="kw">true</span>})</span>
<span id="cb9-554"><a href="#cb9-554" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb9-555"><a href="#cb9-555" aria-hidden="true" tabindex="-1"></a>viewof isGauss <span class="op">=</span> Inputs<span class="op">.</span><span class="fu">toggle</span>({<span class="dt">label</span><span class="op">:</span> <span class="st">"normal"</span><span class="op">,</span><span class="dt">value</span><span class="op">:</span> <span class="kw">true</span>})</span>
<span id="cb9-556"><a href="#cb9-556" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb9-557"><a href="#cb9-557" aria-hidden="true" tabindex="-1"></a>viewof isLogGauss <span class="op">=</span> Inputs<span class="op">.</span><span class="fu">toggle</span>({<span class="dt">label</span><span class="op">:</span> <span class="st">"lognormal"</span><span class="op">,</span><span class="dt">value</span><span class="op">:</span> <span class="kw">true</span>})</span>
<span id="cb9-558"><a href="#cb9-558" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb9-559"><a href="#cb9-559" aria-hidden="true" tabindex="-1"></a>viewof isPareto <span class="op">=</span> Inputs<span class="op">.</span><span class="fu">toggle</span>({<span class="dt">label</span><span class="op">:</span> <span class="st">"Pareto"</span><span class="op">,</span><span class="dt">value</span><span class="op">:</span> <span class="kw">true</span>})</span>
<span id="cb9-560"><a href="#cb9-560" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb9-561"><a href="#cb9-561" aria-hidden="true" tabindex="-1"></a>viewof isWeibull <span class="op">=</span> Inputs<span class="op">.</span><span class="fu">toggle</span>({<span class="dt">label</span><span class="op">:</span> <span class="st">"Weibull"</span><span class="op">,</span><span class="dt">value</span><span class="op">:</span> <span class="kw">true</span>})</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display">
<div>
<div id="ojs-cell-9-1" data-nodetype="declaration">

</div>
</div>
</div>
<div class="cell-output cell-output-display">
<div>
<div id="ojs-cell-9-2" data-nodetype="declaration">

</div>
</div>
</div>
<div class="cell-output cell-output-display">
<div>
<div id="ojs-cell-9-3" data-nodetype="declaration">

</div>
</div>
</div>
<div class="cell-output cell-output-display">
<div>
<div id="ojs-cell-9-4" data-nodetype="declaration">

</div>
</div>
</div>
<div class="cell-output cell-output-display">
<div>
<div id="ojs-cell-9-5" data-nodetype="declaration">

</div>
</div>
</div>
<div class="cell-output cell-output-display">
<div>
<div id="ojs-cell-9-6" data-nodetype="declaration">

</div>
</div>
</div>
</div>
</div>
</div>
</div>
</div>
<div class="quarto-layout-row quarto-layout-valign-top">
<div class="cell quarto-layout-cell" style="flex-basis: 100.0%;justify-content: center;">
<div class="sourceCode cell-code hidden" id="cb10" data-startfrom="568" data-source-offset="-1"><pre class="sourceCode js code-with-copy"><code class="sourceCode javascript" style="counter-reset: source-line 567;"><span id="cb10-568"><a href="#cb10-568" aria-hidden="true" tabindex="-1"></a>yexp <span class="op">=</span> d3<span class="op">.</span><span class="fu">max</span>(d3<span class="op">.</span><span class="fu">range</span>(xmin<span class="op">,</span> xmax<span class="op">,</span> <span class="fl">0.01</span>)<span class="op">.</span><span class="fu">map</span>(t <span class="kw">=&gt;</span> lexp<span class="op">*</span><span class="bu">Math</span><span class="op">.</span><span class="fu">exp</span>(<span class="op">-</span>lexp <span class="op">*</span> t)))</span>
<span id="cb10-569"><a href="#cb10-569" aria-hidden="true" tabindex="-1"></a>ygamma <span class="op">=</span> d3<span class="op">.</span><span class="fu">max</span>(d3<span class="op">.</span><span class="fu">range</span>(xmin<span class="op">,</span> xmax<span class="op">,</span> <span class="fl">0.001</span>)<span class="op">.</span><span class="fu">map</span>(t <span class="kw">=&gt;</span> <span class="fu">gamma</span>(t<span class="op">,</span>agamma<span class="op">,</span>lgamma)))</span>
<span id="cb10-570"><a href="#cb10-570" aria-hidden="true" tabindex="-1"></a>ygauss <span class="op">=</span> d3<span class="op">.</span><span class="fu">max</span>(d3<span class="op">.</span><span class="fu">range</span>(xmin<span class="op">,</span> xmax<span class="op">,</span> <span class="fl">0.01</span>)<span class="op">.</span><span class="fu">map</span>(t <span class="kw">=&gt;</span> <span class="fu">gauss</span>(t<span class="op">,</span>mu<span class="op">,</span>sigma)))</span>
<span id="cb10-571"><a href="#cb10-571" aria-hidden="true" tabindex="-1"></a>yloggauss <span class="op">=</span> d3<span class="op">.</span><span class="fu">max</span>(d3<span class="op">.</span><span class="fu">range</span>(xmin<span class="op">,</span> xmax<span class="op">,</span> <span class="fl">0.001</span>)<span class="op">.</span><span class="fu">map</span>(t <span class="kw">=&gt;</span> <span class="fu">loggauss</span>(t<span class="op">,</span>logmu<span class="op">,</span>logsigma)))</span>
<span id="cb10-572"><a href="#cb10-572" aria-hidden="true" tabindex="-1"></a>ypareto <span class="op">=</span> d3<span class="op">.</span><span class="fu">max</span>(d3<span class="op">.</span><span class="fu">range</span>(xmin<span class="op">,</span> xmax<span class="op">,</span> <span class="fl">0.01</span>)<span class="op">.</span><span class="fu">map</span>(t <span class="kw">=&gt;</span> <span class="fu">pareto</span>(t<span class="op">,</span>apareto<span class="op">,</span>lpareto)))</span>
<span id="cb10-573"><a href="#cb10-573" aria-hidden="true" tabindex="-1"></a>yweibull <span class="op">=</span> d3<span class="op">.</span><span class="fu">max</span>(d3<span class="op">.</span><span class="fu">range</span>(xmin<span class="op">,</span> xmax<span class="op">,</span> <span class="fl">0.01</span>)<span class="op">.</span><span class="fu">map</span>(t <span class="kw">=&gt;</span> <span class="fu">weibull</span>(t<span class="op">,</span>aweibull<span class="op">,</span>bweibull)))</span>
<span id="cb10-574"><a href="#cb10-574" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb10-575"><a href="#cb10-575" aria-hidden="true" tabindex="-1"></a>tfull <span class="op">=</span> d3<span class="op">.</span><span class="fu">max</span>([isExp<span class="op">?</span>yexp<span class="op">:</span><span class="dv">0</span><span class="op">,</span> isGamma<span class="op">?</span>ygamma<span class="op">:</span><span class="dv">0</span><span class="op">,</span> isGauss<span class="op">?</span>ygauss<span class="op">:</span><span class="dv">0</span><span class="op">,</span> isPareto<span class="op">?</span>ypareto<span class="op">:</span><span class="dv">0</span><span class="op">,</span> isWeibull<span class="op">?</span>yweibull<span class="op">:</span><span class="dv">0</span><span class="op">,</span> isLogGauss<span class="op">?</span>yloggauss<span class="op">:</span><span class="dv">0</span>])</span>
<span id="cb10-576"><a href="#cb10-576" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb10-577"><a href="#cb10-577" aria-hidden="true" tabindex="-1"></a>Plot<span class="op">.</span><span class="fu">plot</span>({</span>
<span id="cb10-578"><a href="#cb10-578" aria-hidden="true" tabindex="-1"></a>  <span class="dt">x</span><span class="op">:</span> { <span class="dt">domain</span><span class="op">:</span> [xmin<span class="op">,</span> xmax] }<span class="op">,</span></span>
<span id="cb10-579"><a href="#cb10-579" aria-hidden="true" tabindex="-1"></a>  <span class="dt">y</span><span class="op">:</span> { <span class="dt">domain</span><span class="op">:</span> [<span class="op">-</span>tfull<span class="op">*</span><span class="fl">0.1</span><span class="op">,</span>  tfull<span class="op">*</span><span class="fl">1.2</span>] }<span class="op">,</span></span>
<span id="cb10-580"><a href="#cb10-580" aria-hidden="true" tabindex="-1"></a>  <span class="dt">width</span><span class="op">:</span> <span class="dv">640</span><span class="op">,</span></span>
<span id="cb10-581"><a href="#cb10-581" aria-hidden="true" tabindex="-1"></a>  <span class="dt">height</span><span class="op">:</span> <span class="dv">240</span><span class="op">,</span></span>
<span id="cb10-582"><a href="#cb10-582" aria-hidden="true" tabindex="-1"></a>  <span class="dt">marks</span><span class="op">:</span> [</span>
<span id="cb10-583"><a href="#cb10-583" aria-hidden="true" tabindex="-1"></a>    (isExp <span class="op">==</span> <span class="kw">true</span>)<span class="op">?</span>Plot<span class="op">.</span><span class="fu">line</span>(</span>
<span id="cb10-584"><a href="#cb10-584" aria-hidden="true" tabindex="-1"></a>      d3</span>
<span id="cb10-585"><a href="#cb10-585" aria-hidden="true" tabindex="-1"></a>        <span class="op">.</span><span class="fu">range</span>(xmin<span class="op">,</span> xmax<span class="op">,</span> <span class="fl">0.01</span>)</span>
<span id="cb10-586"><a href="#cb10-586" aria-hidden="true" tabindex="-1"></a>        <span class="op">.</span><span class="fu">map</span>(t <span class="kw">=&gt;</span> [t<span class="op">,</span> lexp<span class="op">*</span><span class="bu">Math</span><span class="op">.</span><span class="fu">exp</span>(<span class="op">-</span>lexp<span class="op">*</span>t)])<span class="op">,</span>{</span>
<span id="cb10-587"><a href="#cb10-587" aria-hidden="true" tabindex="-1"></a>        <span class="dt">strokeWidth</span><span class="op">:</span> <span class="dv">3</span><span class="op">,</span></span>
<span id="cb10-588"><a href="#cb10-588" aria-hidden="true" tabindex="-1"></a>        <span class="dt">stroke</span><span class="op">:</span> d3<span class="op">.</span><span class="at">schemeCategory10</span>[<span class="dv">0</span>]</span>
<span id="cb10-589"><a href="#cb10-589" aria-hidden="true" tabindex="-1"></a>      }</span>
<span id="cb10-590"><a href="#cb10-590" aria-hidden="true" tabindex="-1"></a>    )<span class="op">:</span>Plot<span class="op">.</span><span class="fu">line</span>(</span>
<span id="cb10-591"><a href="#cb10-591" aria-hidden="true" tabindex="-1"></a>      d3</span>
<span id="cb10-592"><a href="#cb10-592" aria-hidden="true" tabindex="-1"></a>        <span class="op">.</span><span class="fu">range</span>(<span class="dv">0</span><span class="op">,</span> <span class="fl">0.01</span><span class="op">,</span> <span class="fl">0.01</span>)</span>
<span id="cb10-593"><a href="#cb10-593" aria-hidden="true" tabindex="-1"></a>        <span class="op">.</span><span class="fu">map</span>(t <span class="kw">=&gt;</span> [t<span class="op">,</span> t])<span class="op">,</span>{</span>
<span id="cb10-594"><a href="#cb10-594" aria-hidden="true" tabindex="-1"></a>        <span class="dt">strokeWidth</span><span class="op">:</span> <span class="dv">0</span><span class="op">,</span></span>
<span id="cb10-595"><a href="#cb10-595" aria-hidden="true" tabindex="-1"></a>        <span class="dt">stroke</span><span class="op">:</span> d3<span class="op">.</span><span class="at">schemeCategory10</span>[<span class="dv">0</span>]</span>
<span id="cb10-596"><a href="#cb10-596" aria-hidden="true" tabindex="-1"></a>      }</span>
<span id="cb10-597"><a href="#cb10-597" aria-hidden="true" tabindex="-1"></a>    )<span class="op">,</span></span>
<span id="cb10-598"><a href="#cb10-598" aria-hidden="true" tabindex="-1"></a>    (isGamma <span class="op">==</span> <span class="kw">true</span>)<span class="op">?</span>Plot<span class="op">.</span><span class="fu">line</span>(</span>
<span id="cb10-599"><a href="#cb10-599" aria-hidden="true" tabindex="-1"></a>      d3</span>
<span id="cb10-600"><a href="#cb10-600" aria-hidden="true" tabindex="-1"></a>        <span class="op">.</span><span class="fu">range</span>(xmin<span class="op">,</span> xmax<span class="op">,</span> <span class="fl">0.01</span>)</span>
<span id="cb10-601"><a href="#cb10-601" aria-hidden="true" tabindex="-1"></a>        <span class="op">.</span><span class="fu">map</span>(t <span class="kw">=&gt;</span> [t<span class="op">,</span> <span class="fu">gamma</span>(t<span class="op">,</span>agamma<span class="op">,</span>lgamma)])<span class="op">,</span>{</span>
<span id="cb10-602"><a href="#cb10-602" aria-hidden="true" tabindex="-1"></a>        <span class="dt">strokeWidth</span><span class="op">:</span> <span class="dv">3</span><span class="op">,</span></span>
<span id="cb10-603"><a href="#cb10-603" aria-hidden="true" tabindex="-1"></a>        <span class="dt">stroke</span><span class="op">:</span> d3<span class="op">.</span><span class="at">schemeCategory10</span>[<span class="dv">1</span>]</span>
<span id="cb10-604"><a href="#cb10-604" aria-hidden="true" tabindex="-1"></a>      }</span>
<span id="cb10-605"><a href="#cb10-605" aria-hidden="true" tabindex="-1"></a>    )<span class="op">:</span>Plot<span class="op">.</span><span class="fu">line</span>(</span>
<span id="cb10-606"><a href="#cb10-606" aria-hidden="true" tabindex="-1"></a>      d3</span>
<span id="cb10-607"><a href="#cb10-607" aria-hidden="true" tabindex="-1"></a>        <span class="op">.</span><span class="fu">range</span>(<span class="dv">0</span><span class="op">,</span> <span class="fl">0.01</span><span class="op">,</span> <span class="fl">0.01</span>)</span>
<span id="cb10-608"><a href="#cb10-608" aria-hidden="true" tabindex="-1"></a>        <span class="op">.</span><span class="fu">map</span>(t <span class="kw">=&gt;</span> [t<span class="op">,</span> t])<span class="op">,</span>{</span>
<span id="cb10-609"><a href="#cb10-609" aria-hidden="true" tabindex="-1"></a>        <span class="dt">strokeWidth</span><span class="op">:</span> <span class="dv">0</span><span class="op">,</span></span>
<span id="cb10-610"><a href="#cb10-610" aria-hidden="true" tabindex="-1"></a>        <span class="dt">stroke</span><span class="op">:</span> d3<span class="op">.</span><span class="at">schemeCategory10</span>[<span class="dv">0</span>]</span>
<span id="cb10-611"><a href="#cb10-611" aria-hidden="true" tabindex="-1"></a>      }</span>
<span id="cb10-612"><a href="#cb10-612" aria-hidden="true" tabindex="-1"></a>    )<span class="op">,</span></span>
<span id="cb10-613"><a href="#cb10-613" aria-hidden="true" tabindex="-1"></a>    (isGauss <span class="op">==</span> <span class="kw">true</span>)<span class="op">?</span>Plot<span class="op">.</span><span class="fu">line</span>(</span>
<span id="cb10-614"><a href="#cb10-614" aria-hidden="true" tabindex="-1"></a>      d3</span>
<span id="cb10-615"><a href="#cb10-615" aria-hidden="true" tabindex="-1"></a>        <span class="op">.</span><span class="fu">range</span>(xmin<span class="op">,</span> xmax<span class="op">,</span> <span class="fl">0.01</span>)</span>
<span id="cb10-616"><a href="#cb10-616" aria-hidden="true" tabindex="-1"></a>        <span class="op">.</span><span class="fu">map</span>(t <span class="kw">=&gt;</span> [t<span class="op">,</span> <span class="fu">gauss</span>(t<span class="op">,</span>muG<span class="op">,</span>sigmaG)])<span class="op">,</span>{</span>
<span id="cb10-617"><a href="#cb10-617" aria-hidden="true" tabindex="-1"></a>        <span class="dt">strokeWidth</span><span class="op">:</span> <span class="dv">3</span><span class="op">,</span></span>
<span id="cb10-618"><a href="#cb10-618" aria-hidden="true" tabindex="-1"></a>        <span class="dt">stroke</span><span class="op">:</span> d3<span class="op">.</span><span class="at">schemeCategory10</span>[<span class="dv">2</span>]</span>
<span id="cb10-619"><a href="#cb10-619" aria-hidden="true" tabindex="-1"></a>      }</span>
<span id="cb10-620"><a href="#cb10-620" aria-hidden="true" tabindex="-1"></a>    )<span class="op">:</span>Plot<span class="op">.</span><span class="fu">line</span>(</span>
<span id="cb10-621"><a href="#cb10-621" aria-hidden="true" tabindex="-1"></a>      d3</span>
<span id="cb10-622"><a href="#cb10-622" aria-hidden="true" tabindex="-1"></a>        <span class="op">.</span><span class="fu">range</span>(<span class="dv">0</span><span class="op">,</span> <span class="fl">0.01</span><span class="op">,</span> <span class="fl">0.01</span>)</span>
<span id="cb10-623"><a href="#cb10-623" aria-hidden="true" tabindex="-1"></a>        <span class="op">.</span><span class="fu">map</span>(t <span class="kw">=&gt;</span> [t<span class="op">,</span> t])<span class="op">,</span>{</span>
<span id="cb10-624"><a href="#cb10-624" aria-hidden="true" tabindex="-1"></a>        <span class="dt">strokeWidth</span><span class="op">:</span> <span class="dv">0</span><span class="op">,</span></span>
<span id="cb10-625"><a href="#cb10-625" aria-hidden="true" tabindex="-1"></a>        <span class="dt">stroke</span><span class="op">:</span> d3<span class="op">.</span><span class="at">schemeCategory10</span>[<span class="dv">0</span>]</span>
<span id="cb10-626"><a href="#cb10-626" aria-hidden="true" tabindex="-1"></a>      }</span>
<span id="cb10-627"><a href="#cb10-627" aria-hidden="true" tabindex="-1"></a>    )<span class="op">,</span></span>
<span id="cb10-628"><a href="#cb10-628" aria-hidden="true" tabindex="-1"></a>    (isLogGauss <span class="op">==</span> <span class="kw">true</span>)<span class="op">?</span>Plot<span class="op">.</span><span class="fu">line</span>(</span>
<span id="cb10-629"><a href="#cb10-629" aria-hidden="true" tabindex="-1"></a>      d3</span>
<span id="cb10-630"><a href="#cb10-630" aria-hidden="true" tabindex="-1"></a>        <span class="op">.</span><span class="fu">range</span>(xmin<span class="op">,</span> xmax<span class="op">,</span> <span class="fl">0.01</span>)</span>
<span id="cb10-631"><a href="#cb10-631" aria-hidden="true" tabindex="-1"></a>        <span class="op">.</span><span class="fu">map</span>(t <span class="kw">=&gt;</span> [t<span class="op">,</span> <span class="fu">loggauss</span>(t<span class="op">,</span>logmu<span class="op">,</span>logsigma)])<span class="op">,</span>{</span>
<span id="cb10-632"><a href="#cb10-632" aria-hidden="true" tabindex="-1"></a>        <span class="dt">strokeWidth</span><span class="op">:</span> <span class="dv">3</span><span class="op">,</span></span>
<span id="cb10-633"><a href="#cb10-633" aria-hidden="true" tabindex="-1"></a>        <span class="dt">stroke</span><span class="op">:</span> d3<span class="op">.</span><span class="at">schemeCategory10</span>[<span class="dv">3</span>]</span>
<span id="cb10-634"><a href="#cb10-634" aria-hidden="true" tabindex="-1"></a>      }</span>
<span id="cb10-635"><a href="#cb10-635" aria-hidden="true" tabindex="-1"></a>    )<span class="op">:</span>Plot<span class="op">.</span><span class="fu">line</span>(</span>
<span id="cb10-636"><a href="#cb10-636" aria-hidden="true" tabindex="-1"></a>      d3</span>
<span id="cb10-637"><a href="#cb10-637" aria-hidden="true" tabindex="-1"></a>        <span class="op">.</span><span class="fu">range</span>(<span class="dv">0</span><span class="op">,</span> <span class="fl">0.01</span><span class="op">,</span> <span class="fl">0.01</span>)</span>
<span id="cb10-638"><a href="#cb10-638" aria-hidden="true" tabindex="-1"></a>        <span class="op">.</span><span class="fu">map</span>(t <span class="kw">=&gt;</span> [t<span class="op">,</span> t])<span class="op">,</span>{</span>
<span id="cb10-639"><a href="#cb10-639" aria-hidden="true" tabindex="-1"></a>        <span class="dt">strokeWidth</span><span class="op">:</span> <span class="dv">0</span><span class="op">,</span></span>
<span id="cb10-640"><a href="#cb10-640" aria-hidden="true" tabindex="-1"></a>        <span class="dt">stroke</span><span class="op">:</span> d3<span class="op">.</span><span class="at">schemeCategory10</span>[<span class="dv">0</span>]</span>
<span id="cb10-641"><a href="#cb10-641" aria-hidden="true" tabindex="-1"></a>      }</span>
<span id="cb10-642"><a href="#cb10-642" aria-hidden="true" tabindex="-1"></a>    )<span class="op">,</span></span>
<span id="cb10-643"><a href="#cb10-643" aria-hidden="true" tabindex="-1"></a>    (isPareto <span class="op">==</span> <span class="kw">true</span>)<span class="op">?</span>Plot<span class="op">.</span><span class="fu">line</span>(</span>
<span id="cb10-644"><a href="#cb10-644" aria-hidden="true" tabindex="-1"></a>      d3</span>
<span id="cb10-645"><a href="#cb10-645" aria-hidden="true" tabindex="-1"></a>        <span class="op">.</span><span class="fu">range</span>(xmin<span class="op">,</span> xmax<span class="op">,</span> <span class="fl">0.01</span>)</span>
<span id="cb10-646"><a href="#cb10-646" aria-hidden="true" tabindex="-1"></a>        <span class="op">.</span><span class="fu">map</span>(t <span class="kw">=&gt;</span> [t<span class="op">,</span> <span class="fu">pareto</span>(t<span class="op">,</span>apareto<span class="op">,</span>lpareto)])<span class="op">,</span>{</span>
<span id="cb10-647"><a href="#cb10-647" aria-hidden="true" tabindex="-1"></a>        <span class="dt">strokeWidth</span><span class="op">:</span> <span class="dv">3</span><span class="op">,</span></span>
<span id="cb10-648"><a href="#cb10-648" aria-hidden="true" tabindex="-1"></a>        <span class="dt">stroke</span><span class="op">:</span> d3<span class="op">.</span><span class="at">schemeCategory10</span>[<span class="dv">4</span>]</span>
<span id="cb10-649"><a href="#cb10-649" aria-hidden="true" tabindex="-1"></a>      }</span>
<span id="cb10-650"><a href="#cb10-650" aria-hidden="true" tabindex="-1"></a>    )<span class="op">:</span>Plot<span class="op">.</span><span class="fu">line</span>(</span>
<span id="cb10-651"><a href="#cb10-651" aria-hidden="true" tabindex="-1"></a>      d3</span>
<span id="cb10-652"><a href="#cb10-652" aria-hidden="true" tabindex="-1"></a>        <span class="op">.</span><span class="fu">range</span>(<span class="dv">0</span><span class="op">,</span> <span class="fl">0.01</span><span class="op">,</span> <span class="fl">0.01</span>)</span>
<span id="cb10-653"><a href="#cb10-653" aria-hidden="true" tabindex="-1"></a>        <span class="op">.</span><span class="fu">map</span>(t <span class="kw">=&gt;</span> [t<span class="op">,</span> t])<span class="op">,</span>{</span>
<span id="cb10-654"><a href="#cb10-654" aria-hidden="true" tabindex="-1"></a>        <span class="dt">strokeWidth</span><span class="op">:</span> <span class="dv">0</span><span class="op">,</span></span>
<span id="cb10-655"><a href="#cb10-655" aria-hidden="true" tabindex="-1"></a>        <span class="dt">stroke</span><span class="op">:</span> d3<span class="op">.</span><span class="at">schemeCategory10</span>[<span class="dv">0</span>]</span>
<span id="cb10-656"><a href="#cb10-656" aria-hidden="true" tabindex="-1"></a>      }</span>
<span id="cb10-657"><a href="#cb10-657" aria-hidden="true" tabindex="-1"></a>    )<span class="op">,</span></span>
<span id="cb10-658"><a href="#cb10-658" aria-hidden="true" tabindex="-1"></a>    (isWeibull <span class="op">==</span> <span class="kw">true</span>)<span class="op">?</span>Plot<span class="op">.</span><span class="fu">line</span>(</span>
<span id="cb10-659"><a href="#cb10-659" aria-hidden="true" tabindex="-1"></a>      d3</span>
<span id="cb10-660"><a href="#cb10-660" aria-hidden="true" tabindex="-1"></a>        <span class="op">.</span><span class="fu">range</span>(xmin<span class="op">,</span> xmax<span class="op">,</span> <span class="fl">0.01</span>)</span>
<span id="cb10-661"><a href="#cb10-661" aria-hidden="true" tabindex="-1"></a>        <span class="op">.</span><span class="fu">map</span>(t <span class="kw">=&gt;</span> [t<span class="op">,</span>  <span class="fu">weibull</span>(t<span class="op">,</span>aweibull<span class="op">,</span>bweibull)])<span class="op">,</span>{</span>
<span id="cb10-662"><a href="#cb10-662" aria-hidden="true" tabindex="-1"></a>        <span class="dt">strokeWidth</span><span class="op">:</span> <span class="dv">3</span><span class="op">,</span></span>
<span id="cb10-663"><a href="#cb10-663" aria-hidden="true" tabindex="-1"></a>        <span class="dt">stroke</span><span class="op">:</span> d3<span class="op">.</span><span class="at">schemeCategory10</span>[<span class="dv">5</span>]</span>
<span id="cb10-664"><a href="#cb10-664" aria-hidden="true" tabindex="-1"></a>      }</span>
<span id="cb10-665"><a href="#cb10-665" aria-hidden="true" tabindex="-1"></a>    )<span class="op">:</span>Plot<span class="op">.</span><span class="fu">line</span>(</span>
<span id="cb10-666"><a href="#cb10-666" aria-hidden="true" tabindex="-1"></a>      d3</span>
<span id="cb10-667"><a href="#cb10-667" aria-hidden="true" tabindex="-1"></a>        <span class="op">.</span><span class="fu">range</span>(<span class="dv">0</span><span class="op">,</span> <span class="fl">0.01</span><span class="op">,</span> <span class="fl">0.01</span>)</span>
<span id="cb10-668"><a href="#cb10-668" aria-hidden="true" tabindex="-1"></a>        <span class="op">.</span><span class="fu">map</span>(t <span class="kw">=&gt;</span> [t<span class="op">,</span> t])<span class="op">,</span>{</span>
<span id="cb10-669"><a href="#cb10-669" aria-hidden="true" tabindex="-1"></a>        <span class="dt">strokeWidth</span><span class="op">:</span> <span class="dv">0</span><span class="op">,</span></span>
<span id="cb10-670"><a href="#cb10-670" aria-hidden="true" tabindex="-1"></a>        <span class="dt">stroke</span><span class="op">:</span> d3<span class="op">.</span><span class="at">schemeCategory10</span>[<span class="dv">0</span>]</span>
<span id="cb10-671"><a href="#cb10-671" aria-hidden="true" tabindex="-1"></a>      }</span>
<span id="cb10-672"><a href="#cb10-672" aria-hidden="true" tabindex="-1"></a>    )<span class="op">,</span></span>
<span id="cb10-673"><a href="#cb10-673" aria-hidden="true" tabindex="-1"></a>      Plot<span class="op">.</span><span class="fu">ruleX</span>([xmin])<span class="op">,</span></span>
<span id="cb10-674"><a href="#cb10-674" aria-hidden="true" tabindex="-1"></a>      Plot<span class="op">.</span><span class="fu">ruleY</span>([<span class="dv">0</span>])<span class="op">,</span></span>
<span id="cb10-675"><a href="#cb10-675" aria-hidden="true" tabindex="-1"></a>      Plot<span class="op">.</span><span class="fu">axisX</span>({ <span class="dt">y</span><span class="op">:</span> <span class="dv">0</span> })<span class="op">,</span></span>
<span id="cb10-676"><a href="#cb10-676" aria-hidden="true" tabindex="-1"></a>      Plot<span class="op">.</span><span class="fu">axisY</span>({ <span class="dt">x</span><span class="op">:</span> xmin })</span>
<span id="cb10-677"><a href="#cb10-677" aria-hidden="true" tabindex="-1"></a>  ]</span>
<span id="cb10-678"><a href="#cb10-678" aria-hidden="true" tabindex="-1"></a>})</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display">
<div>
<div id="ojs-cell-10-1" data-nodetype="declaration">

</div>
</div>
</div>
<div class="cell-output cell-output-display">
<div>
<div id="ojs-cell-10-2" data-nodetype="declaration">

</div>
</div>
</div>
<div class="cell-output cell-output-display">
<div>
<div id="ojs-cell-10-3" data-nodetype="declaration">

</div>
</div>
</div>
<div class="cell-output cell-output-display">
<div>
<div id="ojs-cell-10-4" data-nodetype="declaration">

</div>
</div>
</div>
<div class="cell-output cell-output-display">
<div>
<div id="ojs-cell-10-5" data-nodetype="declaration">

</div>
</div>
</div>
<div class="cell-output cell-output-display">
<div>
<div id="ojs-cell-10-6" data-nodetype="declaration">

</div>
</div>
</div>
<div class="cell-output cell-output-display">
<div>
<div id="ojs-cell-10-7" data-nodetype="declaration">

</div>
</div>
</div>
<div class="cell-output cell-output-display">
<div>
<div id="ojs-cell-10-8" data-nodetype="expression">

</div>
</div>
</div>
</div>
</div>
<div class="quarto-layout-row quarto-layout-valign-top">
<div class="cell quarto-layout-cell" style="flex-basis: 100.0%;justify-content: center;">
<div class="sourceCode cell-code hidden" id="cb11" data-startfrom="682" data-source-offset="0"><pre class="sourceCode js code-with-copy"><code class="sourceCode javascript" style="counter-reset: source-line 681;"><span id="cb11-682"><a href="#cb11-682" aria-hidden="true" tabindex="-1"></a><span class="fu">swatches</span>({</span>
<span id="cb11-683"><a href="#cb11-683" aria-hidden="true" tabindex="-1"></a>  <span class="dt">color</span><span class="op">:</span> d3<span class="op">.</span><span class="fu">scaleOrdinal</span>([<span class="fu">tex</span><span class="vs">`</span><span class="sc">\d</span><span class="vs">isplaystyle f_X(x)=</span><span class="sc">\l</span><span class="vs">ambda e^{-</span><span class="sc">\l</span><span class="vs">ambda x}`</span><span class="op">,</span> <span class="fu">tex</span><span class="vs">`</span><span class="sc">\d</span><span class="vs">isplaystyle f_X(x)=</span><span class="sc">\f</span><span class="vs">rac{</span><span class="sc">\l</span><span class="vs">ambda^</span><span class="sc">\a</span><span class="vs">lpha}{</span><span class="sc">\G</span><span class="vs">amma(</span><span class="sc">\a</span><span class="vs">lpha)}x^{</span><span class="sc">\a</span><span class="vs">lpha-1} e^{-</span><span class="sc">\l</span><span class="vs">ambda x}`</span><span class="op">,</span> <span class="fu">tex</span><span class="vs">`</span><span class="sc">\d</span><span class="vs">isplaystyle f_X(x)=</span><span class="sc">\f</span><span class="vs">rac1{</span><span class="sc">\s</span><span class="vs">igma</span><span class="sc">\s</span><span class="vs">qrt{2</span><span class="sc">\p</span><span class="vs">i}}e^{-</span><span class="sc">\f</span><span class="vs">rac1{2</span><span class="sc">\s</span><span class="vs">igma^2}(x-</span><span class="sc">\m</span><span class="vs">u)^2}`</span><span class="op">,</span> <span class="fu">tex</span><span class="vs">`</span><span class="sc">\d</span><span class="vs">isplaystyle f_X(x)= </span><span class="sc">\f</span><span class="vs">rac{1}{x</span><span class="sc">\s</span><span class="vs">igma</span><span class="sc">\s</span><span class="vs">qrt{2</span><span class="sc">\p</span><span class="vs">i}}</span><span class="sc">\e</span><span class="vs">xp</span><span class="sc">\b</span><span class="vs">iggl(- </span><span class="sc">\f</span><span class="vs">rac{(</span><span class="sc">\l</span><span class="vs">n x -</span><span class="sc">\m</span><span class="vs">u)^2}{2</span><span class="sc">\s</span><span class="vs">igma^2}</span><span class="sc">\b</span><span class="vs">iggr)`</span><span class="op">,</span> <span class="fu">tex</span><span class="vs">`</span><span class="sc">\d</span><span class="vs">isplaystyle f_X(x)=</span><span class="sc">\f</span><span class="vs">rac{</span><span class="sc">\a</span><span class="vs">lpha</span><span class="sc">\l</span><span class="vs">ambda^</span><span class="sc">\a</span><span class="vs">lpha}{(</span><span class="sc">\l</span><span class="vs">ambda+x)^{</span><span class="sc">\a</span><span class="vs">lpha+1}}`</span><span class="op">,</span> <span class="fu">tex</span><span class="vs">`</span><span class="sc">\d</span><span class="vs">isplaystyle f_X(x)=ab x^{b-1}e^{-a x^b}`</span>]<span class="op">,</span> d3<span class="op">.</span><span class="at">schemeCategory10</span>)</span>
<span id="cb11-684"><a href="#cb11-684" aria-hidden="true" tabindex="-1"></a>    })</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display">
<div id="ojs-cell-11" data-nodetype="expression">

</div>
</div>
</div>
</div>
</div>
<figcaption class="figure quarto-float-caption quarto-float-fig" id="fig-comparison-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
Figure&nbsp;1.7: Comparison of right tails for the density functions
</figcaption>
</figure>
</div>
<div class="callout callout-style-default callout-note no-icon callout-titled">
<div class="callout-header d-flex align-content-center">
<div class="callout-icon-container">
<i class="callout-icon no-icon"></i>
</div>
<div class="callout-title-container flex-fill">
1.20 Cheracterisations
</div>
</div>
<div class="callout-body-container callout-body">
<p>A random variable is uniquely determined by either of CDF, PDF, MGF. Note that the sequence of all moments, in general, does not determine the distribution uniquely (Hamburger moment problem).</p>
<p>Relations: <span id="eq-1.34"><span class="math display">\[
f_X(x) = F'_X(x),
\tag{1.34}\]</span></span> <span id="eq-1.35"><span class="math display">\[
F_X(x)  = \int_{-\infty}^x f_x(y)\,dy,
\tag{1.35}\]</span></span> <span id="eq-1.36"><span class="math display">\[
m_{k,X} = M_X^{(k)}(0).
\tag{1.36}\]</span></span></p>
</div>
</div>
<div class="callout callout-style-default callout-note no-icon callout-titled">
<div class="callout-header d-flex align-content-center">
<div class="callout-icon-container">
<i class="callout-icon no-icon"></i>
</div>
<div class="callout-title-container flex-fill">
1.21 Likelihood
</div>
</div>
<div class="callout-body-container callout-body">
<p>Let <span class="math inline">\(X:\Omega\to\mathbb{R}\)</span> be a random variable whose distribution depends on a parameter <span class="math inline">\(\theta\in\mathbb{R}\)</span>.</p>
<p>Suppose that we observe the data <span class="math inline">\(x_1,\ldots,x_n\)</span> which is the output of this random variable <span class="math inline">\(X\)</span> in course of <span class="math inline">\(n\)</span> independent trials.</p>
<p>In other words, we can say that we observe that i.i.d.r.v. <span class="math inline">\(X_1,\ldots, X_n\)</span> with <span class="math inline">\(X_i\sim X\)</span>, <span class="math inline">\(1\leq i\leq n\)</span>, take certain values: <span class="math inline">\(X_1=x_1,\ldots, X_n=x_n\)</span>.</p>
<p>The <strong>likelihood</strong>, or <strong>likelihood function</strong>, is the function <span class="math inline">\(\mathcal{L}(\theta)=\mathcal{L}(\theta\mid x_1,\ldots,x_n)\)</span> of the unknown parameter <span class="math inline">\(\theta\)</span> (given the observed data <span class="math inline">\(x_1,\ldots,x_n\)</span>) which is equal to:</p>
<ul>
<li><p>(if <span class="math inline">\(X\)</span> is a discrete random variable) the probability to observe this data (given the value of the parameter <span class="math inline">\(\theta\)</span>): <span id="eq-1.37"><span class="math display">\[
\begin{aligned}
\mathcal{L}(\theta)&amp;=\mathcal{L}(\theta\mid x_1,\ldots,x_n)\\
:&amp;=\mathbb{P}(X_1=x_1,\ldots,X_n=x_n\mid \theta)
\\&amp;= \mathbb{P}(X_1=x_1\mid \theta)\ldots \mathbb{P}(X_n=x_n\mid \theta).
\end{aligned}
\tag{1.37}\]</span></span></p></li>
<li><p>(if <span class="math inline">\(X\)</span> is a continuous random variable with the PDF <span class="math inline">\(f_X(x)=f_X(x\mid\theta)\)</span>) <span id="eq-1.38"><span class="math display">\[
\begin{aligned}
\mathcal{L}(\theta)&amp;=\mathcal{L}(\theta\mid x_1,\ldots,x_n)\\
:&amp;=f_X(x_1\mid\theta)f_X(x_2\mid\theta)\ldots f_X(x_n\mid\theta).
\end{aligned}
\tag{1.38}\]</span></span></p></li>
</ul>
</div>
</div>
<div class="callout callout-style-default callout-note no-icon callout-titled">
<div class="callout-header d-flex align-content-center">
<div class="callout-icon-container">
<i class="callout-icon no-icon"></i>
</div>
<div class="callout-title-container flex-fill">
1.22 Maximum likelihood estimator
</div>
</div>
<div class="callout-body-container callout-body">
<p>The <strong>maximum likelihood estimator</strong><span class="math inline">\(\theta_*\)</span> of the parameter <span class="math inline">\(\theta\)</span> is the argument of the maximum of the likelihood function: <span id="eq-1.39"><span class="math display">\[
\theta_*=\mathop{\mathrm{argmax}}_\theta\mathcal{L}(\theta),
\tag{1.39}\]</span></span> that means that <span id="eq-1.40"><span class="math display">\[
\mathcal{L}(\theta_*) = \max_{\theta}\mathcal{L}(\theta).
\tag{1.40}\]</span></span></p>
<p>The standard approach to find <span class="math inline">\(\theta_*\)</span> is to consider the <strong>log-likelihood function</strong> <span id="eq-1.41"><span class="math display">\[
L(\theta):=L(\theta\mid x_1,\ldots,x_n)=\ln \mathcal{L}(\theta\mid x_1,\ldots,x_n).
\tag{1.41}\]</span></span></p>
<p>Thus, in the discrete case, <span id="eq-1.42"><span class="math display">\[
L(\theta) = \ln \mathbb{P}(X_1=x_1\mid \theta)+ \ldots + \ln \mathbb{P}(X_n=x_n\mid \theta),
\tag{1.42}\]</span></span> whereas, in the continuous case <span id="eq-1.43"><span class="math display">\[
L(\theta) = \ln f_X(x_1\mid\theta)+ \ldots + \ln f_X(x_n\mid\theta),
\tag{1.43}\]</span></span></p>
<p>Then <span class="math inline">\(\theta_*\)</span> is the point of maximum for both <span class="math inline">\(\mathcal{L}\)</span> and <span class="math inline">\(L\)</span>: <span id="eq-1.44"><span class="math display">\[
\theta_*=\mathop{\mathrm{argmax}}_\theta L(\theta)=\mathop{\mathrm{argmax}}_\theta\mathcal{L}(\theta).
\tag{1.44}\]</span></span></p>
</div>
</div>
<div class="callout callout-style-default callout-warning no-icon callout-titled">
<div class="callout-header d-flex align-content-center">
<div class="callout-icon-container">
<i class="callout-icon no-icon"></i>
</div>
<div class="callout-title-container flex-fill">
1.23 Example: Discrete case
</div>
</div>
<div class="callout-body-container callout-body">
<p>Let <span class="math inline">\(X\sim Po(\lambda)\)</span>, i.e. <span class="math display">\[
\mathbb{P}(X=k)=\frac{\lambda^k}{k!}e^{-\lambda}, \quad k\geq0.
\]</span> Suppose we have a sample of <span class="math inline">\(n\)</span> values of <span class="math inline">\(X\)</span>: <span class="math inline">\(k_1,\ldots,k_n\)</span>, and we want to estimate <span class="math inline">\(\lambda\)</span> (here <span class="math inline">\(\theta=\lambda\)</span>). Then <span class="math display">\[
\begin{aligned}
\mathcal{L}(\lambda)&amp;=\mathbb{P}(X=k_1\mid\lambda)\ldots \mathbb{P}(X=k_n\mid\lambda)\\
&amp; = \frac{\lambda^{k_1}}{k_1!}e^{-\lambda}\cdot\ldots\cdot \frac{\lambda^{k_n}}{k_n!}e^{-\lambda}\\
&amp; = \underbrace{\frac{1}{k_1!\ldots k_n!}}_{=: c&gt;0}\lambda^{k_1+\ldots+k_n}e^{-\lambda n},
\end{aligned}
\]</span> and therefore, <span class="math display">\[
\begin{aligned}
L(\lambda)&amp;=\ln\mathcal{L}(\lambda)
\\&amp; = \ln c + (k_1+\ldots+k_n)\ln\lambda-\lambda n.
\end{aligned}
\]</span> Then <span class="math display">\[
L'(\lambda) = \frac{k_1+\ldots+k_n}{\lambda}-n,
\]</span> and hence, <span class="math inline">\(L'(\lambda)=0\)</span> iff <span class="math display">\[
{\lambda = \frac{k_1+\ldots+k_n}{n}}.
\]</span></p>
<p>Since <span class="math display">\[
L''(\lambda) = (L'(\lambda))'=-\frac{k_1+\ldots+k_n}{\lambda^2}&lt;0,
\]</span> the found value <span class="math inline">\(\lambda_* = \frac{k_1+\ldots+k_n}{n}\)</span> is the point of maximum of <span class="math inline">\(L\)</span>, hence, it is the maximum likelihood estimator for the parameter <span class="math inline">\(\lambda\)</span>.</p>
</div>
</div>
<div class="callout callout-style-default callout-tip no-icon callout-titled">
<div class="callout-header d-flex align-content-center">
<div class="callout-icon-container">
<i class="callout-icon no-icon"></i>
</div>
<div class="callout-title-container flex-fill">
1.24 Remark: Relation to the LLN
</div>
</div>
<div class="callout-body-container callout-body">
<p>Note that, by the law of large numbers (LLN), if <span class="math inline">\(X_i\sim X\sim Po(\lambda)\)</span>, <span class="math inline">\(i\in\mathbb{N}\)</span>, then <span class="math display">\[
\frac{X_1+\ldots+X_n}{n} \to \mathbb{E}(X)=\lambda, \qquad n\to\infty.
\]</span> In other words, the maximum likelihood estimator converges to the theoretical value is the size of the sample converges to infinity.</p>
</div>
</div>
<div class="callout callout-style-default callout-warning no-icon callout-titled">
<div class="callout-header d-flex align-content-center">
<div class="callout-icon-container">
<i class="callout-icon no-icon"></i>
</div>
<div class="callout-title-container flex-fill">
1.25 Example: Continuous case
</div>
</div>
<div class="callout-body-container callout-body">
<p>Let <span class="math inline">\(X\sim Exp(\lambda)\)</span>. Suppose we have a sample of <span class="math inline">\(n\)</span> values of <span class="math inline">\(X\)</span>: <span class="math inline">\(x_1,\ldots,x_n\)</span>. Then <span class="math display">\[
\begin{aligned}
\mathcal{L}(\lambda) &amp;= f_X(x_1\mid \lambda)\ldots f_X(x_n\mid \lambda)\\
&amp;=\lambda e^{-\lambda x_1}\ldots \lambda e^{-\lambda x_n}= \lambda^n e^{-\lambda(x_1+\ldots +x_n)}.
\end{aligned}
\]</span></p>
<p>Therefore, <span class="math display">\[
\begin{aligned}
L(\lambda)&amp;= \ln \mathcal L(\lambda)
\\&amp;= n \ln \lambda - \lambda(x_1+\ldots +x_n),
\end{aligned}
\]</span> so <span class="math inline">\(L'(\lambda)=0\)</span> iff <span class="math display">\[
\begin{gathered}
\frac{n}{\lambda} -(x_1+\ldots +x_n)=0,\\
{\lambda_*= \frac{n}{x_1+\ldots +x_n}}.
\end{gathered}
\]</span> Note that <span class="math inline">\(L''(\lambda)=-\dfrac{n}{\lambda^2}\)</span>, in particular, <span class="math inline">\(L''(\lambda_*)&lt;0\)</span>, i.e.&nbsp;<span class="math inline">\(\lambda_*\)</span> is indeed the maximum likelihood estimator for the parameter <span class="math inline">\(\lambda\)</span>.</p>
<p>Finally, note that if <span class="math inline">\(X_i\sim X\sim Exp(\lambda)\)</span>, then, by LLN, <span class="math display">\[
\frac{X_1+\ldots+X_n}{n}\to \mathbb{E}(X)=\frac{1}{\lambda}, \qquad n\to\infty.
\]</span></p>
</div>
</div>
<div class="callout callout-style-default callout-note no-icon callout-titled">
<div class="callout-header d-flex align-content-center">
<div class="callout-icon-container">
<i class="callout-icon no-icon"></i>
</div>
<div class="callout-title-container flex-fill">
1.26 The method of moments
</div>
</div>
<div class="callout-body-container callout-body">
<p>If the number of parameters is bigger than <span class="math inline">\(1\)</span>, the maximum likelihood estimation may be challenging as one would need to find the point of maximum for a function of several variables (though it can be still effectively done numerically).</p>
<p>Another method to estimate unknown parameters of the distribution is the <strong>method of moments</strong>. Namely, assuming that we have a sample of <span class="math inline">\(n\)</span> values <span class="math inline">\(x_1,\ldots,x_n\)</span> of a random variable <span class="math inline">\(X\)</span> which is believed to be followed a probability distribution which depends on <span class="math inline">\(k\)</span> unknown parameters <span class="math inline">\(\theta=(\theta_1,\ldots,\theta_k)\)</span>.</p>
<p>Then, we consider the first <span class="math inline">\(k\)</span> moments of the random variable <span class="math inline">\(X\)</span> (i.e.&nbsp;the moments of the population): <span class="math display">\[
m_j = \mathbb{E}(X^j\mid \theta), \qquad 1\leq j\leq k.
\]</span></p>
<p>Next, for the given data <span class="math inline">\(x_1,\ldots,x_n\)</span>, we consider <span class="math inline">\(k\)</span> averaged moments (i.e.&nbsp;the moments of the sample): <span class="math display">\[
\overline{m}_j = \frac{1}{n}\sum_{l=1}^n x_l ^j, \qquad 1\leq j\leq k.
\]</span></p>
<p>After this, we need to equate <span class="math inline">\(k\)</span> quantities: <span class="math display">\[
m_j = \overline{m}_j, \qquad 1\leq j\leq k,
\]</span> to determine <span class="math inline">\(k\)</span> unknown parameters <span class="math inline">\(\theta_1,\ldots,\theta_k\)</span>.</p>
</div>
</div>



</main> <!-- /main -->
<script type="ojs-module-contents">
{"contents":[{"methodName":"interpret","cellName":"ojs-cell-1","inline":false,"source":"mathfn = require('https://bundle.run/mathfn@1.1.0')\n\n"},{"methodName":"interpret","cellName":"ojs-cell-2","inline":false,"source":"\nviewof l = Inputs.range([0.1, 10], { value: 1, step: 0.001, label: tex`\\lambda:` })\n\nviewof xmexp = Inputs.range([1, 100], { value: 10, step: 1, label: tex`x_\\mathrm{max}` })\n\nymaxexp = d3.max(d3.range(0, xmexp, 0.01).map(t => l*Math.exp(-l * t)))\n\nPlot.plot({\n  x: { domain: [-0.1, xmexp] },\n  y: { domain: [-0.1*ymaxexp, ymaxexp*1.2] },\n  width: 640,\n  height: 240,\n  marks: [\n    Plot.line(\n      d3\n        .range(0, xmexp, 0.1)\n        .map(t => [\n          t,\n          l*Math.exp(-l * t)\n        ]),{\n        strokeWidth: 3,\n        stroke: \"steelblue\"\n      }\n    ),\n      Plot.ruleX([0]),\n      Plot.ruleY([0]),\n      Plot.axisX({ y: 0 }),\n      Plot.axisY({ x: 0 })\n  ]\n})\n"},{"methodName":"interpret","cellName":"ojs-cell-3","inline":false,"source":"viewof a = Inputs.range([0.1, 10], { value: 1, step: 0.001, label: tex`\\alpha:` })\nviewof l2 = Inputs.range([0.1, 10], { value: 1, step: 0.001, label: tex`\\lambda:` })\nviewof xmgamma = Inputs.range([1, 100], { value: 10, step: 1, label: tex`x_\\mathrm{max}` })\n\nfunction gamma(t,alpha,lambda){\n  return ((lambda**alpha)/mathfn.gamma(alpha))*(t**(alpha-1))*Math.exp(-lambda * t);\n}\n\n\nymaxgamma = d3.max(d3.range(0.1, xmgamma, 0.001).map(t => gamma(t,a,l2)))\n\n\nPlot.plot({\n  x: { domain: [0.1, xmgamma] },\n  y: { domain: [-0.1*ymaxgamma, ymaxgamma*1.2] },\n  width: 640,\n  height: 240,\n  marks: [\n    Plot.line(\n      d3\n        .range(0,xmgamma, 0.01)\n        .map(t => [t, gamma(t,a,l2)]),{\n        strokeWidth: 3,\n        stroke: \"steelblue\"\n      }\n    ),\n      Plot.ruleX([0]),\n      Plot.ruleY([0]),\n      Plot.axisX({ y: 0 }),\n      Plot.axisY({ x: 0 })\n  ]\n})\n"},{"methodName":"interpret","cellName":"ojs-cell-4","inline":false,"source":"viewof mu = Inputs.range([-0.7*xmgauss, 0.7*xmgauss], { value: 0, step: 0.001, label: tex`\\mu:` })\nviewof sigma = Inputs.range([0.1, 10], { value: 1, step: 0.001, label: tex`\\sigma:` })\nviewof xmgauss = Inputs.range([1, 100], { value: 10, step: 1, label: tex`x_\\mathrm{max}` })\n\nfunction gauss(t,mu,sigma){\n  return Math.exp(-(1/(2*sigma**2))*(t-mu)**2)/(sigma*Math.sqrt(2*Math.PI));\n}\n\nymaxgauss = d3.max(d3.range(-xmgauss, xmgauss, 0.01).map(t => gauss(t,mu,sigma)))\n\nPlot.plot({\n  x: { domain: [-xmgauss, xmgauss] },\n  y: { domain: [-ymaxgauss*0.1, ymaxgauss*1.2] },\n  width: 640,\n  height: 240,\n  marks: [\n    Plot.line(\n      d3\n        .range(-xmgauss, xmgauss, 0.01)\n        .map(t => [t, gauss(t,mu,sigma)]),{\n        strokeWidth: 3,\n        stroke: \"steelblue\"\n      }\n    ),\n      Plot.ruleX([0]),\n      Plot.ruleY([0]),\n      Plot.axisX({ y: 0 }),\n      Plot.axisY({ x: 0 })\n  ]\n})\n"},{"methodName":"interpret","cellName":"ojs-cell-5","inline":false,"source":"viewof mu2 = Inputs.range([0, xmloggauss*0.5], { value: 0, step: 0.001, label: tex`\\mu:` })\nviewof sigma2 = Inputs.range([0.1, 10], { value: 1, step: 0.001, label: tex`\\sigma:` })\nviewof xmloggauss = Inputs.range([1, 100], { value: 10, step: 1, label: tex`x_\\mathrm{max}` })\n\nfunction loggauss(t,mu,sigma){\n  return Math.exp(-(1/(2*sigma**2))*(Math.log(t)-mu)**2)/(t*sigma*Math.sqrt(2*Math.PI));\n}\n\nymaxloggauss = d3.max(d3.range(0.01, xmloggauss, 0.001).map(t => loggauss(t,mu2,sigma2)))\n\nPlot.plot({\n  x: { domain: [0.1,xmloggauss] },\n  y: { domain: [-ymaxloggauss*0.1,  ymaxloggauss*1.2] },\n  width: 640,\n  height: 240,\n  marks: [\n    Plot.line(\n      d3\n        .range(0.1, xmloggauss, 0.01)\n        .map(t => [t, loggauss(t,mu2,sigma2)]),{\n        strokeWidth: 3,\n        stroke: \"steelblue\"\n      }\n    ),\n      Plot.ruleX([0]),\n      Plot.ruleY([0]),\n      Plot.axisX({ y: 0 }),\n      Plot.axisY({ x: 0 })\n  ]\n})\n"},{"methodName":"interpret","cellName":"ojs-cell-6","inline":false,"source":"viewof ap = Inputs.range([0.1, 10], { value: 0.1, step: 0.001, label: tex`\\alpha:` })\nviewof lp = Inputs.range([0.1, 10], { value: 0.1, step: 0.001, label: tex`\\lambda:` })\nviewof xmpareto = Inputs.range([1, 100], { value: 10, step: 1, label: tex`x_\\mathrm{max}` })\n\nfunction pareto(t,alpha,lambda){\n  return alpha*lambda**alpha*(t+lambda)**(-1-alpha);\n}\n\nymaxpareto = d3.max(d3.range(0.1, xmpareto, 0.01).map(t => pareto(t,ap,lp)))\n\nPlot.plot({\n  x: { domain: [0.1,xmpareto] },\n  y: { domain: [-ymaxpareto*0.1,  ymaxpareto*1.2] },\n  width: 640,\n  height: 240,\n  marks: [\n    Plot.line(\n      d3\n        .range(0.1, xmpareto, 0.01)\n        .map(t => [t, pareto(t,ap,lp)]),{\n        strokeWidth: 3,\n        stroke: \"steelblue\"\n      }\n    ),\n      Plot.ruleX([0]),\n      Plot.ruleY([0]),\n      Plot.axisX({ y: 0 }),\n      Plot.axisY({ x: 0 })\n  ]\n})\n"},{"methodName":"interpret","cellName":"ojs-cell-7","inline":false,"source":"viewof aw = Inputs.range([0.1, 10], { value: 0.1, step: 0.001, label: tex`a:` })\nviewof bw = Inputs.range([0.1, 10], { value: 0.1, step: 0.001, label: tex`b:` })\nviewof xmweibull = Inputs.range([1, 100], { value: 10, step: 1, label: tex`x_\\mathrm{max}` })\n\nfunction weibull(t,a,b){\n  return a*b*t**(b-1)*Math.exp(-a*t**b);\n}\n\nymaxweibull = d3.max(d3.range(0.1, xmweibull, 0.01).map(t => weibull(t,aw,bw)))\n\nPlot.plot({\n  x: { domain: [0.1,xmweibull] },\n  y: { domain: [-ymaxweibull*0.1,  ymaxweibull*1.2] },\n  width: 640,\n  height: 240,\n  marks: [\n    Plot.line(\n      d3\n        .range(0.1, xmweibull, 0.01)\n        .map(t => [t,  weibull(t,aw,bw)]),{\n        strokeWidth: 3,\n        stroke: \"steelblue\"\n      }\n    ),\n      Plot.ruleX([0]),\n      Plot.ruleY([0]),\n      Plot.axisX({ y: 0 }),\n      Plot.axisY({ x: 0 })\n  ]\n})\n"},{"methodName":"interpret","cellName":"ojs-cell-8","inline":false,"source":"import {legend, swatches} from \"@d3/color-legend\"\n\n\nviewof xmin = Inputs.range([0.1, xmax*0.9], { value: 0.1, step: 0.1, label: tex`x_\\mathrm{min}` })\n\nviewof xmax = Inputs.range([1,1000], { value: 10, step: 1, label: tex`x_\\mathrm{max}` })\n\nviewof lexp = Inputs.range([0.1, 10], { value: 1, step: 0.001, label: tex`\\lambda_{Exp}:` })\n\nviewof agamma = Inputs.range([0.1, 10], { value: 1, step: 0.001, label: tex`\\alpha_{Gamma}:` })\nviewof lgamma = Inputs.range([0.1, 10], { value: 1, step: 0.001, label: tex`\\lambda_{Gamma}:` })\n\nviewof muG = Inputs.range([0.1, 10], { value: 0, step: 0.001, label: tex`\\mu_{\\mathcal{N}}:` })\nviewof sigmaG = Inputs.range([0.1, 10], { value: 1, step: 0.001, label: tex`\\sigma_{\\mathcal{N}}:` })\n\nviewof logmu = Inputs.range([0.1, 10], { value: 0, step: 0.001, label: tex`\\mu_{\\log\\mathcal{N}}:` })\nviewof logsigma = Inputs.range([0.1, 10], { value: 1, step: 0.001, label: tex`\\sigma_{\\log\\mathcal{N}}:` })\n\nviewof apareto = Inputs.range([0.1, 10], { value: 0.1, step: 0.001, label: tex`\\alpha_{Pareto}:` })\n\nviewof lpareto = Inputs.range([0.1, 10], { value: 0.1, step: 0.001, label: tex`\\lambda_{Pareto}:` })\n\nviewof aweibull = Inputs.range([0.1, 10], { value: 0.1, step: 0.001, label: tex`a_{Weibull}:` })\n\nviewof bweibull = Inputs.range([0.1, 10], { value: 0.1, step: 0.001, label: tex`b_{Weibull}:` })\n"},{"methodName":"interpret","cellName":"ojs-cell-9","inline":false,"source":"viewof isExp = Inputs.toggle({label: \"exponential\",value: true})\n\nviewof isGamma = Inputs.toggle({label: \"gamma\",value: true})\n\nviewof isGauss = Inputs.toggle({label: \"normal\",value: true})\n\nviewof isLogGauss = Inputs.toggle({label: \"lognormal\",value: true})\n\nviewof isPareto = Inputs.toggle({label: \"Pareto\",value: true})\n\nviewof isWeibull = Inputs.toggle({label: \"Weibull\",value: true})\n"},{"methodName":"interpret","cellName":"ojs-cell-10","inline":false,"source":"\nyexp = d3.max(d3.range(xmin, xmax, 0.01).map(t => lexp*Math.exp(-lexp * t)))\nygamma = d3.max(d3.range(xmin, xmax, 0.001).map(t => gamma(t,agamma,lgamma)))\nygauss = d3.max(d3.range(xmin, xmax, 0.01).map(t => gauss(t,mu,sigma)))\nyloggauss = d3.max(d3.range(xmin, xmax, 0.001).map(t => loggauss(t,logmu,logsigma)))\nypareto = d3.max(d3.range(xmin, xmax, 0.01).map(t => pareto(t,apareto,lpareto)))\nyweibull = d3.max(d3.range(xmin, xmax, 0.01).map(t => weibull(t,aweibull,bweibull)))\n\ntfull = d3.max([isExp?yexp:0, isGamma?ygamma:0, isGauss?ygauss:0, isPareto?ypareto:0, isWeibull?yweibull:0, isLogGauss?yloggauss:0])\n\nPlot.plot({\n  x: { domain: [xmin, xmax] },\n  y: { domain: [-tfull*0.1,  tfull*1.2] },\n  width: 640,\n  height: 240,\n  marks: [\n    (isExp == true)?Plot.line(\n      d3\n        .range(xmin, xmax, 0.01)\n        .map(t => [t, lexp*Math.exp(-lexp*t)]),{\n        strokeWidth: 3,\n        stroke: d3.schemeCategory10[0]\n      }\n    ):Plot.line(\n      d3\n        .range(0, 0.01, 0.01)\n        .map(t => [t, t]),{\n        strokeWidth: 0,\n        stroke: d3.schemeCategory10[0]\n      }\n    ),\n    (isGamma == true)?Plot.line(\n      d3\n        .range(xmin, xmax, 0.01)\n        .map(t => [t, gamma(t,agamma,lgamma)]),{\n        strokeWidth: 3,\n        stroke: d3.schemeCategory10[1]\n      }\n    ):Plot.line(\n      d3\n        .range(0, 0.01, 0.01)\n        .map(t => [t, t]),{\n        strokeWidth: 0,\n        stroke: d3.schemeCategory10[0]\n      }\n    ),\n    (isGauss == true)?Plot.line(\n      d3\n        .range(xmin, xmax, 0.01)\n        .map(t => [t, gauss(t,muG,sigmaG)]),{\n        strokeWidth: 3,\n        stroke: d3.schemeCategory10[2]\n      }\n    ):Plot.line(\n      d3\n        .range(0, 0.01, 0.01)\n        .map(t => [t, t]),{\n        strokeWidth: 0,\n        stroke: d3.schemeCategory10[0]\n      }\n    ),\n    (isLogGauss == true)?Plot.line(\n      d3\n        .range(xmin, xmax, 0.01)\n        .map(t => [t, loggauss(t,logmu,logsigma)]),{\n        strokeWidth: 3,\n        stroke: d3.schemeCategory10[3]\n      }\n    ):Plot.line(\n      d3\n        .range(0, 0.01, 0.01)\n        .map(t => [t, t]),{\n        strokeWidth: 0,\n        stroke: d3.schemeCategory10[0]\n      }\n    ),\n    (isPareto == true)?Plot.line(\n      d3\n        .range(xmin, xmax, 0.01)\n        .map(t => [t, pareto(t,apareto,lpareto)]),{\n        strokeWidth: 3,\n        stroke: d3.schemeCategory10[4]\n      }\n    ):Plot.line(\n      d3\n        .range(0, 0.01, 0.01)\n        .map(t => [t, t]),{\n        strokeWidth: 0,\n        stroke: d3.schemeCategory10[0]\n      }\n    ),\n    (isWeibull == true)?Plot.line(\n      d3\n        .range(xmin, xmax, 0.01)\n        .map(t => [t,  weibull(t,aweibull,bweibull)]),{\n        strokeWidth: 3,\n        stroke: d3.schemeCategory10[5]\n      }\n    ):Plot.line(\n      d3\n        .range(0, 0.01, 0.01)\n        .map(t => [t, t]),{\n        strokeWidth: 0,\n        stroke: d3.schemeCategory10[0]\n      }\n    ),\n      Plot.ruleX([xmin]),\n      Plot.ruleY([0]),\n      Plot.axisX({ y: 0 }),\n      Plot.axisY({ x: xmin })\n  ]\n})\n"},{"methodName":"interpret","cellName":"ojs-cell-11","inline":false,"source":"\nswatches({\n  color: d3.scaleOrdinal([tex`\\displaystyle f_X(x)=\\lambda e^{-\\lambda x}`, tex`\\displaystyle f_X(x)=\\frac{\\lambda^\\alpha}{\\Gamma(\\alpha)}x^{\\alpha-1} e^{-\\lambda x}`, tex`\\displaystyle f_X(x)=\\frac1{\\sigma\\sqrt{2\\pi}}e^{-\\frac1{2\\sigma^2}(x-\\mu)^2}`, tex`\\displaystyle f_X(x)= \\frac{1}{x\\sigma\\sqrt{2\\pi}}\\exp\\biggl(- \\frac{(\\ln x -\\mu)^2}{2\\sigma^2}\\biggr)`, tex`\\displaystyle f_X(x)=\\frac{\\alpha\\lambda^\\alpha}{(\\lambda+x)^{\\alpha+1}}`, tex`\\displaystyle f_X(x)=ab x^{b-1}e^{-a x^b}`], d3.schemeCategory10)\n    })\n"},{"methodName":"interpretQuiet","source":"shinyInput('l')"},{"methodName":"interpretQuiet","source":"shinyInput('xmexp')"},{"methodName":"interpretQuiet","source":"shinyInput('a')"},{"methodName":"interpretQuiet","source":"shinyInput('l2')"},{"methodName":"interpretQuiet","source":"shinyInput('xmgamma')"},{"methodName":"interpretQuiet","source":"shinyInput('mu')"},{"methodName":"interpretQuiet","source":"shinyInput('sigma')"},{"methodName":"interpretQuiet","source":"shinyInput('xmgauss')"},{"methodName":"interpretQuiet","source":"shinyInput('mu2')"},{"methodName":"interpretQuiet","source":"shinyInput('sigma2')"},{"methodName":"interpretQuiet","source":"shinyInput('xmloggauss')"},{"methodName":"interpretQuiet","source":"shinyInput('ap')"},{"methodName":"interpretQuiet","source":"shinyInput('lp')"},{"methodName":"interpretQuiet","source":"shinyInput('xmpareto')"},{"methodName":"interpretQuiet","source":"shinyInput('aw')"},{"methodName":"interpretQuiet","source":"shinyInput('bw')"},{"methodName":"interpretQuiet","source":"shinyInput('xmweibull')"},{"methodName":"interpretQuiet","source":"shinyInput('xmin')"},{"methodName":"interpretQuiet","source":"shinyInput('xmax')"},{"methodName":"interpretQuiet","source":"shinyInput('lexp')"},{"methodName":"interpretQuiet","source":"shinyInput('agamma')"},{"methodName":"interpretQuiet","source":"shinyInput('lgamma')"},{"methodName":"interpretQuiet","source":"shinyInput('muG')"},{"methodName":"interpretQuiet","source":"shinyInput('sigmaG')"},{"methodName":"interpretQuiet","source":"shinyInput('logmu')"},{"methodName":"interpretQuiet","source":"shinyInput('logsigma')"},{"methodName":"interpretQuiet","source":"shinyInput('apareto')"},{"methodName":"interpretQuiet","source":"shinyInput('lpareto')"},{"methodName":"interpretQuiet","source":"shinyInput('aweibull')"},{"methodName":"interpretQuiet","source":"shinyInput('bweibull')"},{"methodName":"interpretQuiet","source":"shinyInput('isExp')"},{"methodName":"interpretQuiet","source":"shinyInput('isGamma')"},{"methodName":"interpretQuiet","source":"shinyInput('isGauss')"},{"methodName":"interpretQuiet","source":"shinyInput('isLogGauss')"},{"methodName":"interpretQuiet","source":"shinyInput('isPareto')"},{"methodName":"interpretQuiet","source":"shinyInput('isWeibull')"}]}
</script>
<script type="module">
if (window.location.protocol === "file:") { alert("The OJS runtime does not work with file:// URLs. Please use a web server to view this document."); }
window._ojs.paths.runtimeToDoc = "../..";
window._ojs.paths.runtimeToRoot = "../..";
window._ojs.paths.docToRoot = "";
window._ojs.selfContained = false;
window._ojs.runtime.interpretFromScriptTags();
</script>
<script id="quarto-html-after-body" type="application/javascript">
window.document.addEventListener("DOMContentLoaded", function (event) {
  const toggleBodyColorMode = (bsSheetEl) => {
    const mode = bsSheetEl.getAttribute("data-mode");
    const bodyEl = window.document.querySelector("body");
    if (mode === "dark") {
      bodyEl.classList.add("quarto-dark");
      bodyEl.classList.remove("quarto-light");
    } else {
      bodyEl.classList.add("quarto-light");
      bodyEl.classList.remove("quarto-dark");
    }
  }
  const toggleBodyColorPrimary = () => {
    const bsSheetEl = window.document.querySelector("link#quarto-bootstrap");
    if (bsSheetEl) {
      toggleBodyColorMode(bsSheetEl);
    }
  }
  toggleBodyColorPrimary();  
  const icon = "";
  const anchorJS = new window.AnchorJS();
  anchorJS.options = {
    placement: 'right',
    icon: icon
  };
  anchorJS.add('.anchored');
  const isCodeAnnotation = (el) => {
    for (const clz of el.classList) {
      if (clz.startsWith('code-annotation-')) {                     
        return true;
      }
    }
    return false;
  }
  const clipboard = new window.ClipboardJS('.code-copy-button', {
    text: function(trigger) {
      const codeEl = trigger.previousElementSibling.cloneNode(true);
      for (const childEl of codeEl.children) {
        if (isCodeAnnotation(childEl)) {
          childEl.remove();
        }
      }
      return codeEl.innerText;
    }
  });
  clipboard.on('success', function(e) {
    // button target
    const button = e.trigger;
    // don't keep focus
    button.blur();
    // flash "checked"
    button.classList.add('code-copy-button-checked');
    var currentTitle = button.getAttribute("title");
    button.setAttribute("title", "Copied!");
    let tooltip;
    if (window.bootstrap) {
      button.setAttribute("data-bs-toggle", "tooltip");
      button.setAttribute("data-bs-placement", "left");
      button.setAttribute("data-bs-title", "Copied!");
      tooltip = new bootstrap.Tooltip(button, 
        { trigger: "manual", 
          customClass: "code-copy-button-tooltip",
          offset: [0, -8]});
      tooltip.show();    
    }
    setTimeout(function() {
      if (tooltip) {
        tooltip.hide();
        button.removeAttribute("data-bs-title");
        button.removeAttribute("data-bs-toggle");
        button.removeAttribute("data-bs-placement");
      }
      button.setAttribute("title", currentTitle);
      button.classList.remove('code-copy-button-checked');
    }, 1000);
    // clear code selection
    e.clearSelection();
  });
  function tippyHover(el, contentFn, onTriggerFn, onUntriggerFn) {
    const config = {
      allowHTML: true,
      maxWidth: 500,
      delay: 100,
      arrow: false,
      appendTo: function(el) {
          return el.parentElement;
      },
      interactive: true,
      interactiveBorder: 10,
      theme: 'quarto',
      placement: 'bottom-start',
    };
    if (contentFn) {
      config.content = contentFn;
    }
    if (onTriggerFn) {
      config.onTrigger = onTriggerFn;
    }
    if (onUntriggerFn) {
      config.onUntrigger = onUntriggerFn;
    }
    window.tippy(el, config); 
  }
  const noterefs = window.document.querySelectorAll('a[role="doc-noteref"]');
  for (var i=0; i<noterefs.length; i++) {
    const ref = noterefs[i];
    tippyHover(ref, function() {
      // use id or data attribute instead here
      let href = ref.getAttribute('data-footnote-href') || ref.getAttribute('href');
      try { href = new URL(href).hash; } catch {}
      const id = href.replace(/^#\/?/, "");
      const note = window.document.getElementById(id);
      return note.innerHTML;
    });
  }
  const xrefs = window.document.querySelectorAll('a.quarto-xref');
  const processXRef = (id, note) => {
    // Strip column container classes
    const stripColumnClz = (el) => {
      el.classList.remove("page-full", "page-columns");
      if (el.children) {
        for (const child of el.children) {
          stripColumnClz(child);
        }
      }
    }
    stripColumnClz(note)
    const typesetMath = (el) => {
      if (window.MathJax) {
        // MathJax Typeset
        window.MathJax.typeset([el]);
      } else if (window.katex) {
        // KaTeX Render
        var mathElements = el.getElementsByClassName("math");
        var macros = [];
        for (var i = 0; i < mathElements.length; i++) {
          var texText = mathElements[i].firstChild;
          if (mathElements[i].tagName == "SPAN") {
            window.katex.render(texText.data, mathElements[i], {
              displayMode: mathElements[i].classList.contains('display'),
              throwOnError: false,
              macros: macros,
              fleqn: false
            });
          }
        }
      }
    }
    if (id === null || id.startsWith('sec-')) {
      // Special case sections, only their first couple elements
      const container = document.createElement("div");
      if (note.children && note.children.length > 2) {
        for (let i = 0; i < 2; i++) {
          container.appendChild(note.children[i].cloneNode(true));
        }
        typesetMath(container);
        return container.innerHTML
      } else {
        typesetMath(note);
        return note.innerHTML;
      }
    } else {
      // Remove any anchor links if they are present
      const anchorLink = note.querySelector('a.anchorjs-link');
      if (anchorLink) {
        anchorLink.remove();
      }
      typesetMath(note);
      return note.innerHTML;
    }
  }
  for (var i=0; i<xrefs.length; i++) {
    const xref = xrefs[i];
    tippyHover(xref, undefined, function(instance) {
      instance.disable();
      let url = xref.getAttribute('href');
      let hash = undefined; 
      if (url.startsWith('#')) {
        hash = url;
      } else {
        try { hash = new URL(url).hash; } catch {}
      }
      if (hash) {
        const id = hash.replace(/^#\/?/, "");
        const note = window.document.getElementById(id);
        if (note !== null) {
          try {
            const html = processXRef(id, note.cloneNode(true));
            instance.setContent(html);
          } finally {
            instance.enable();
            instance.show();
          }
        } else {
          // See if we can fetch this
          fetch(url.split('#')[0])
          .then(res => res.text())
          .then(html => {
            const parser = new DOMParser();
            const htmlDoc = parser.parseFromString(html, "text/html");
            const note = htmlDoc.getElementById(id);
            if (note !== null) {
              const html = processXRef(id, note);
              instance.setContent(html);
            } 
          }).finally(() => {
            instance.enable();
            instance.show();
          });
        }
      } else {
        // See if we can fetch a full url (with no hash to target)
        // This is a special case and we should probably do some content thinning / targeting
        fetch(url)
        .then(res => res.text())
        .then(html => {
          const parser = new DOMParser();
          const htmlDoc = parser.parseFromString(html, "text/html");
          const note = htmlDoc.querySelector('main.content');
          if (note !== null) {
            // This should only happen for chapter cross references
            // (since there is no id in the URL)
            // remove the first header
            if (note.children.length > 0 && note.children[0].tagName === "HEADER") {
              note.children[0].remove();
            }
            const html = processXRef(null, note);
            instance.setContent(html);
          } 
        }).finally(() => {
          instance.enable();
          instance.show();
        });
      }
    }, function(instance) {
    });
  }
      let selectedAnnoteEl;
      const selectorForAnnotation = ( cell, annotation) => {
        let cellAttr = 'data-code-cell="' + cell + '"';
        let lineAttr = 'data-code-annotation="' +  annotation + '"';
        const selector = 'span[' + cellAttr + '][' + lineAttr + ']';
        return selector;
      }
      const selectCodeLines = (annoteEl) => {
        const doc = window.document;
        const targetCell = annoteEl.getAttribute("data-target-cell");
        const targetAnnotation = annoteEl.getAttribute("data-target-annotation");
        const annoteSpan = window.document.querySelector(selectorForAnnotation(targetCell, targetAnnotation));
        const lines = annoteSpan.getAttribute("data-code-lines").split(",");
        const lineIds = lines.map((line) => {
          return targetCell + "-" + line;
        })
        let top = null;
        let height = null;
        let parent = null;
        if (lineIds.length > 0) {
            //compute the position of the single el (top and bottom and make a div)
            const el = window.document.getElementById(lineIds[0]);
            top = el.offsetTop;
            height = el.offsetHeight;
            parent = el.parentElement.parentElement;
          if (lineIds.length > 1) {
            const lastEl = window.document.getElementById(lineIds[lineIds.length - 1]);
            const bottom = lastEl.offsetTop + lastEl.offsetHeight;
            height = bottom - top;
          }
          if (top !== null && height !== null && parent !== null) {
            // cook up a div (if necessary) and position it 
            let div = window.document.getElementById("code-annotation-line-highlight");
            if (div === null) {
              div = window.document.createElement("div");
              div.setAttribute("id", "code-annotation-line-highlight");
              div.style.position = 'absolute';
              parent.appendChild(div);
            }
            div.style.top = top - 2 + "px";
            div.style.height = height + 4 + "px";
            div.style.left = 0;
            let gutterDiv = window.document.getElementById("code-annotation-line-highlight-gutter");
            if (gutterDiv === null) {
              gutterDiv = window.document.createElement("div");
              gutterDiv.setAttribute("id", "code-annotation-line-highlight-gutter");
              gutterDiv.style.position = 'absolute';
              const codeCell = window.document.getElementById(targetCell);
              const gutter = codeCell.querySelector('.code-annotation-gutter');
              gutter.appendChild(gutterDiv);
            }
            gutterDiv.style.top = top - 2 + "px";
            gutterDiv.style.height = height + 4 + "px";
          }
          selectedAnnoteEl = annoteEl;
        }
      };
      const unselectCodeLines = () => {
        const elementsIds = ["code-annotation-line-highlight", "code-annotation-line-highlight-gutter"];
        elementsIds.forEach((elId) => {
          const div = window.document.getElementById(elId);
          if (div) {
            div.remove();
          }
        });
        selectedAnnoteEl = undefined;
      };
        // Handle positioning of the toggle
    window.addEventListener(
      "resize",
      throttle(() => {
        elRect = undefined;
        if (selectedAnnoteEl) {
          selectCodeLines(selectedAnnoteEl);
        }
      }, 10)
    );
    function throttle(fn, ms) {
    let throttle = false;
    let timer;
      return (...args) => {
        if(!throttle) { // first call gets through
            fn.apply(this, args);
            throttle = true;
        } else { // all the others get throttled
            if(timer) clearTimeout(timer); // cancel #2
            timer = setTimeout(() => {
              fn.apply(this, args);
              timer = throttle = false;
            }, ms);
        }
      };
    }
      // Attach click handler to the DT
      const annoteDls = window.document.querySelectorAll('dt[data-target-cell]');
      for (const annoteDlNode of annoteDls) {
        annoteDlNode.addEventListener('click', (event) => {
          const clickedEl = event.target;
          if (clickedEl !== selectedAnnoteEl) {
            unselectCodeLines();
            const activeEl = window.document.querySelector('dt[data-target-cell].code-annotation-active');
            if (activeEl) {
              activeEl.classList.remove('code-annotation-active');
            }
            selectCodeLines(clickedEl);
            clickedEl.classList.add('code-annotation-active');
          } else {
            // Unselect the line
            unselectCodeLines();
            clickedEl.classList.remove('code-annotation-active');
          }
        });
      }
  const findCites = (el) => {
    const parentEl = el.parentElement;
    if (parentEl) {
      const cites = parentEl.dataset.cites;
      if (cites) {
        return {
          el,
          cites: cites.split(' ')
        };
      } else {
        return findCites(el.parentElement)
      }
    } else {
      return undefined;
    }
  };
  var bibliorefs = window.document.querySelectorAll('a[role="doc-biblioref"]');
  for (var i=0; i<bibliorefs.length; i++) {
    const ref = bibliorefs[i];
    const citeInfo = findCites(ref);
    if (citeInfo) {
      tippyHover(citeInfo.el, function() {
        var popup = window.document.createElement('div');
        citeInfo.cites.forEach(function(cite) {
          var citeDiv = window.document.createElement('div');
          citeDiv.classList.add('hanging-indent');
          citeDiv.classList.add('csl-entry');
          var biblioDiv = window.document.getElementById('ref-' + cite);
          if (biblioDiv) {
            citeDiv.innerHTML = biblioDiv.innerHTML;
          }
          popup.appendChild(citeDiv);
        });
        return popup.innerHTML;
      });
    }
  }
});
</script>
</div> <!-- /content -->
<footer class="footer">
  <div class="nav-footer">
    <div class="nav-footer-left">
<p>© Copyright 2024, Dmitri Finkelshtein</p>
</div>   
    <div class="nav-footer-center">
<p>MA-365/M65: Lecture Notes</p>
</div>
    <div class="nav-footer-right">
<p>This page is built with <a href="https://quarto.org/">Quarto</a>.</p>
</div>
  </div>
</footer>




</body></html>